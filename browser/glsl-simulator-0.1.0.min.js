/*
  glsl-simulator.js 0.1.0
  https://www.github.com/burg/glsl-simulator/

  Copyright (c) 2014, Brian Burg <burg@cs.uw.edu>
  Copyright (c) 2014, Xiao Sophia Wang.
  All rights reserved.

  Distributed under the terms of the Simplified BSD License:

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice, this
     list of conditions and the following disclaimer.
  2. Redistributions in binary form must reproduce the above copyright notice,
     this list of conditions and the following disclaimer in the documentation
     and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var GLSL=function(){var i={define:function(e,t){var n=e.replace(/(^|\/)[^/]+$/,"$1"),r={exports:{}};t(r,function(e){for(var t=n+e,r=/[^\/]+\/\.\.\/|\.\//;r.test(t);)t=t.replace(r,"");return i[t]}),this[e]=r.exports}};return i.define("error",function(e,t){var r={Error:{}};r.Error.Type={VertexShaderParsing:"error-type-vertex-shader-parsing",FragmentShaderParsing:"error-type-fragment-shader-parsing",VertexShaderTranslation:"error-type-vertex-shader-translation",FragmentShaderTranslation:"error-type-fragment-shader-translation",VertexShaderExecution:"error-type-vertex-shader-execution",FragmentShaderExecution:"error-type-fragment-shader-execution"},e.exports=r.Error}),i.define("events",function(e,t){var s={Object:function(){}};s.Object.addConstructorFunctions=function(e){for(var t in s.Object){var r=s.Object[t];"function"==typeof r&&r!==arguments.callee&&(e[t]=r)}},s.Object.addEventListener=function(e,t,r){if(r=r||null,console.assert(e,"Object.addEventListener: invalid event type ",e,"(listener: ",t,"thisObject: ",r,")"),e&&(console.assert(t,"Object.addEventListener: invalid listener ",t,"(event type: ",e,"thisObject: ",r,")"),t)){this._listeners||(this._listeners={});var n=this._listeners[e];n=n||(this._listeners[e]=[]);for(var i=0;i<n.length;++i)if(n[i].listener===t&&n[i].thisObject===r)return;n.push({thisObject:r,listener:t})}},s.Object.removeEventListener=function(e,t,r){if(e=e||null,t=t||null,r=r||null,this._listeners)if(e){var n=this._listeners[e];if(n){for(var i=n.length-1;0<=i;--i)t&&n[i].listener===t&&n[i].thisObject===r?n.splice(i,1):!t&&r&&n[i].thisObject===r&&n.splice(i,1);n.length||delete this._listeners[e],Object.keys(this._listeners).length||delete this._listeners}}else for(e in this._listeners)this.removeEventListener(e,t,r)},s.Object.removeAllListeners=function(){delete this._listeners},s.Object.hasEventListeners=function(e){return!(!this._listeners||!this._listeners[e])},s.Object.prototype={constructor:s.Object,addEventListener:s.Object.addEventListener,removeEventListener:s.Object.removeEventListener,removeAllListeners:s.Object.removeAllListeners,hasEventListeners:s.Object.hasEventListeners,dispatchEventToListeners:function(n,e){var i=new s.Event(this,n,e);function t(e){if(e&&e._listeners&&e._listeners[n]&&!i._stoppedPropagation)for(var t=e._listeners[n].slice(0),r=0;r<t.length&&(t[r].listener.call(t[r].thisObject,i),!i._stoppedPropagation);++r);}t(this),i._stoppedPropagation=!1;for(var r=this.constructor;r&&(t(r),r.prototype.__proto__);)r=r.prototype.__proto__.constructor;return i.defaultPrevented}},s.Event=function(e,t,r){this.target=e,this.type=t,this.data=r,this.defaultPrevented=!1,this._stoppedPropagation=!1},s.Event.prototype={constructor:s.Event,stopPropagation:function(){this._stoppedPropagation=!0},preventDefault:function(){this.defaultPrevented=!0}},e.exports=s}),i.define("runtime/vector",function(e,t){Runtime={vec:function(e){if(this instanceof Runtime.vec)return this.d=e,this;for(var t=[],r=0;r<arguments.length;++r)arguments[r]instanceof Runtime.vec?t=t.concat(arguments[r].get().slice()):"number"==typeof arguments[r]&&t.push(arguments[r]);return new Runtime.vec(t)}},Runtime.vec.prototype={constructor:Runtime.vec,cast:function(e){if(void 0===e||e===this.dimensions()){switch(this.dimensions()){case 2:return new Runtime.Vec2(this.d);case 3:return new Runtime.Vec3(this.d);case 4:return new Runtime.Vec4(this.d)}return this}if(e<this.dimensions())return this.d.splice(e,this.dimensions()-e),this.cast();if(1!=this.dimensions())return this;for(var t=1;t<e;++t)this.d.push(this.d[0]);return this.cast()},get:function(e){if(void 0===e)return this.d;if("string"!=typeof e)return e>=this.dimensions()?null:this.d[e];for(var t=[],r=0;r<e.length;++r)switch(e.charAt(r)){case"x":case"r":case"s":t.push(this.d[0]);break;case"y":case"g":case"t":2<=this.dimensions()&&t.push(this.d[1]);break;case"z":case"b":case"p":3<=this.dimensions()&&t.push(this.d[2]);break;case"w":case"a":case"q":4<=this.dimensions()&&t.push(this.d[3])}return 1===t.length?t[0]:Runtime.vec.apply(null,t).cast()},set:function(e,t){if("number"==typeof e)return e<this.dimensions()&&(this.d[e]=t),this;if("string"!=typeof e)throw new Error("Unknown field or index selector '"+e+"' for Runtime.vec");for(var r=0;r<e.length;++r){var n="number"==typeof t?t:t.get(r);switch(e.charAt(r)){case"x":case"r":case"s":this.set(0,n);break;case"y":case"g":case"t":2<=this.dimensions()&&this.set(1,n);break;case"z":case"b":case"p":3<=this.dimensions()&&this.set(2,n);break;case"w":case"a":case"q":4<=this.dimensions()&&this.set(3,n);break;default:throw new Error("Unknown field or index selector character '"+e.charAt(r)+"' for Runtime.vec")}}return this},dimensions:function(){return this.d.length},add:function(e){if(e instanceof Runtime.vec)for(var t=0;t<this.d.length;++t)this.d[t]+=e.d[t];else{if("number"!=typeof e)throw new Error("Unexpected argument to vec.add");for(t=0;t<this.d.length;++t)this.d[t]+=e}return this},negate:function(){for(var e=0;e<this.d.length;++e)this.d[e]=-this.d[e];return this},subtract:function(e){if(e instanceof Runtime.vec)for(var t=0;t<this.d.length;++t)this.d[t]-=e.d[t];else{if("number"!=typeof e)throw new Error("Unexpected argument to vec.subtract");for(t=0;t<this.d.length;++t)this.d[t]-=e}return this},multiply:function(e){if(e instanceof Runtime.vec){if(!this._op_check(e))return;for(var t=0;t<this.d.length;++t)this.d[t]*=e.d[t];return this}for(t=0;t<this.d.length;++t)this.d[t]*=e;return this},divide:function(e){if(e instanceof Runtime.vec)for(var t=0;t<this.d.length;++t)this.d[t]/=e.d[t];else{if("number"!=typeof e)throw new Error("Unexpected argument to vec.add");e=e||1e-7;for(t=0;t<this.d.length;++t)this.d[t]/=e}return this},equal:function(e){if(this._op_check(e)){for(var t=0;t<this.d.length;++t)if(this.d[t]!=e.d[t])return!1;return!0}},dot:function(e){if(this._op_check(e)){for(var t=0,r=0;r<this.d.length;++r)t+=this.d[r]*e.d[r];return t}},normalize:function(){for(var e=this.length(),t=0;t<this.d.length;++t)this.d[t]/=e;return this},length:function(){return Math.sqrt(this.length2())},length2:function(){for(var e=0,t=0;t<this.d.length;++t)e+=this.d[t]*this.d[t];return e},_op_check:function(e){return e instanceof Runtime.vec?e.dimensions()==this.dimensions()||(console.error("unable to operate on two vecs of different dimensions."),!1):(console.error("argument to vec operation is not a vec."),!1)}},Runtime.Vec2=function(e){return this instanceof Runtime.Vec2?2==e.length?(this.d=e,this):void console.error("2 arguments to Vec2 is expected."):Runtime.vec.apply(null,arguments).cast(2)},Runtime.Vec2.prototype={constructor:Runtime.Vec2,__proto__:Runtime.vec.prototype},Runtime.Vec3=function(e){return this instanceof Runtime.Vec3?3==e.length?(this.d=e,this):void console.error("3 arguments to Vec3 is expected."):Runtime.vec.apply(null,arguments).cast(3)},Runtime.Vec3.prototype={constructor:Runtime.Vec3,__proto__:Runtime.vec.prototype},Runtime.Vec3.prototype.cross=function(e){return 3!=e.dimensions()&&console.error("arguments to Vec3.cross() should be Vec3."),Runtime.Vec3(this.get(1)*e.get(2)-this.get(2)*e.get(1),this.get(2)*e.get(0)-this.get(0)*e.get(2),this.get(0)*e.get(1)-this.get(1)*e.get(0))},Runtime.Vec4=function(e){return this instanceof Runtime.Vec4?4==e.length?(this.d=e,this):void console.error("4 arguments to Vec4 is expected."):Runtime.vec.apply(null,arguments).cast(4)},Runtime.Vec4.prototype={constructor:Runtime.Vec4,__proto__:Runtime.vec.prototype},e.exports={vec:Runtime.vec,Vec2:Runtime.Vec2,Vec3:Runtime.Vec3,Vec4:Runtime.Vec4}}),i.define("runtime/matrix",function(e,t){var o={};o.vec=t("./vector").vec,o.mat=function(e){if(this instanceof o.mat)return this.d=e,this;var t=[];if(e instanceof o.mat){for(var r=e.d.length,n=0;n<r;n++)t.push(e.d[n].slice());return new o.mat(t)}if(e instanceof o.vec){for(r=arguments.length,n=0;n<r;n++)t.push([]);for(n=0;n<r;n++)for(var i=0;i<r;i++)i<arguments[n].dimensions()?t[i].push(arguments[n].get(i)):t[i].push(0);return new o.mat(t)}for(r=Math.floor(Math.sqrt(arguments.length)),n=0;n<r;n++)t.push([]);for(n=0;n<r;n++)for(i=0;i<r;i++)t[i].push(arguments[n*r+i]);return new o.mat(t)},o.mat.prototype={constructor:o.mat,cast:function(){if(0==arguments.length||arguments[0]==this.dimensions()){switch(this.dimensions()){case 2:return new o.Mat2(this.d);case 3:return new o.Mat3(this.d);case 4:return new o.Mat4(this.d)}return this}var e=arguments[0];if(e<this.dimensions()){for(var t in this.d.splice(e,this.dimensions()-e),this.d)this.d[t].splice(e,this.d[t].length-e);return this.cast()}var r=1==this.dimensions()?this.d[0][0]:1;for(var t in this.d)for(var n=this.dimensions();n<e;n++)this.d[t].push(0);for(t=this.dimensions();t<e;t++){this.d.push([]);for(n=0;n<e;n++)t==n?this.d[t].push(r):this.d[t].push(0)}return this.cast()},get:function(){if(0==arguments.length)return null;var e=arguments[0];if(e>=this.dimensions())return null;var t=o.vec.apply(null,this.d[e]);if(1==arguments.length)return t.cast();var r=arguments[1];return t.get(r)},set:function(){if(arguments.length<2)return this;var e=arguments[0];if(e>=this.dimensions())return this;if(2==arguments.length){for(var t=arguments[1],r=0;r<this.dimensions();r++)r<t.dimensions()?this.d[e][r]=t.get(r):this.d[e][r]=0;return this}r=arguments[1];var n=arguments[2];return"number"==typeof(t=o.vec.apply(null,this.d[e]).set(r,n))?this.d[e][r]=t:this.d[e]=t.d,this},dimensions:function(){return this.d.length},equal:function(e){if(!this._op_check(e))return!1;if(this.dimensions()!=e.dimensions())return!1;for(var t=0;t<this.dimensions();t++)for(var r=0;r<this.dimensions();r++)if(this.d[t][r]!=e.d[t][r])return!1;return!0},add:function(e){return this._op(e,"+")},subtract:function(e){return this._op(e,"-")},matrixCompMult:function(e){return this._op(e,"*")},divide:function(e){return this._op(e,"/")},multiply:function(e){if(e instanceof o.mat){if(!this._op_check(e))return this;for(var t=o.mat(e).subtract(e),r=0;r<this.dimensions();r++)for(var n=0;n<this.dimensions();n++)for(var i=0;i<this.dimensions();i++)t.d[n][r]+=this.d[i][r]*e.d[n][i];return t}if(e instanceof o.vec){if(!this._op_check_vec(v))return this;for(t=o.vec(e).subtract(e),r=0;r<this.dimensions();r++){var s=0;for(n=0;n<this.dimensions();n++)s+=this.d[n][r]*e.get(n);t.set(r,s)}return t}for(r=0;r<this.dimensions();r++)for(n=0;n<this.dimensions();n++)this.d[r][n]*=e;return this},_op:function(e,t){if(!this._op_check(e))return this;for(var r=0;r<this.dimensions();r++)for(var n=0;n<this.dimensions();n++)"+"==t?this.d[r][n]+=e.d[r][n]:"-"==t?this.d[r][n]-=e.d[r][n]:"*"==t?this.d[r][n]*=e.d[r][n]:"/"==t&&(this.d[r][n]/=e.d[r][n]);return this},_op_check:function(e){return e instanceof o.mat?e.dimensions()==this.dimensions()||(console.error("unable to operate on two mats of different dimensions."),!1):(console.error("argument to mat operation is not a mat."),!1)},_op_check_vec:function(e){return e instanceof o.vec?e.dimensions()==this.dimensions()||(console.error("unable to operate on mat and vec of different dimensions."),!1):(console.error("argument is not a vec."),!1)}},o.Mat2=function(e){return this instanceof o.Mat2?2==e.length?(this.d=e,this):void console.error("2 arguments to Mat2 is expected."):o.mat.apply(null,arguments).cast(2)},o.Mat2.prototype={constructor:o.Mat2,__proto__:o.mat.prototype},o.Mat3=function(e){return this instanceof o.Mat3?3==e.length?(this.d=e,this):void console.error("3 dimensions of Mat3 is expected."):o.mat.apply(null,arguments).cast(3)},o.Mat3.prototype={constructor:o.Mat3,__proto__:o.mat.prototype},o.Mat4=function(e){return this instanceof o.Mat4?4==e.length?(this.d=e,this):void console.error("4 dimensions of Mat4 is expected."):o.mat.apply(null,arguments).cast(4)},o.Mat4.prototype={constructor:o.Mat4,__proto__:o.mat.prototype},e.exports={mat:o.mat,Mat2:o.Mat2,Mat3:o.Mat3,Mat4:o.Mat4}}),i.define("runtime/access",function(e,t){var r={};r.vec=t("./vector").vec,r.mat=t("./matrix").mat;var n={get:function(){if(0!=arguments.length){var e=arguments[0];return e instanceof r.vec?arguments.length<2?e:e.get(arguments[1]):e instanceof r.mat?arguments.length<2?e:2==arguments.length?e.get(arguments[1]):e.get(arguments[1],arguments[2]):e}},set:function(){if(0!=arguments.length){var e=arguments[0];return e instanceof r.vec?arguments.length<3?e:e.set(arguments[1],arguments[2]):e instanceof r.mat?arguments.length<3?e:3==arguments.length?e.set(arguments[1],arguments[2]):e.set(arguments[1],arguments[2],arguments[3]):e}}};e.exports=n}),i.define("runtime/internal",function(e,t){var s={},n=t("./vector");s.vec=n.vec,s.Vec2=n.Vec2,s.Vec3=n.Vec3,s.Vec4=n.Vec4;var i={_evalVec:function(){var e=arguments[arguments.length-1];r=s.vec(arguments[0]).cast();for(var t=0;t<arguments[0].dimensions();t++){for(var n=[],i=0;i<arguments.length-1;i++)n.push(arguments[i].get(t));r.set(t,e.apply(this,n))}return r},_extVec:function(e,t){if(e instanceof s.vec)return e;switch(t.dimensions()){case 2:return s.Vec2(e);case 3:return s.Vec3(e);case 4:return s.Vec4(e)}return e},_compare:function(e,t,r){var n=s.vec(e).subtract(e);if("<"==r)for(var i=0;i<e.dimensions();i++)n.set(i,e.get(i)<t.get(i)?1:0);else if("<="==r)for(i=0;i<e.dimensions();i++)n.set(i,e.get(i)<=t.get(i)?1:0);else if(">"==r)for(i=0;i<e.dimensions();i++)n.set(i,e.get(i)>t.get(i)?1:0);else if(">="==r)for(i=0;i<e.dimensions();i++)n.set(i,e.get(i)>=t.get(i)?1:0);else if("=="==r)for(i=0;i<e.dimensions();i++)n.set(i,e.get(i)==t.get(i)?1:0);else if("!="==r)for(i=0;i<e.dimensions();i++)n.set(i,e.get(i)!=t.get(i)?1:0);return n},_op_check:function(){for(var e=0;e<arguments.length;e++){if(!(arguments[e]instanceof s.vec))throw new Error("Expected argument to be instanceof Runtime.vec!");if(0<e&&arguments[e].dimensions()!=arguments[e-1].dimensions())throw new Error("Expected binary operands to have the same dimensions!")}return!0},_checkNumber:function(){for(var e=0;e<arguments.length;e++)if("number"!=typeof arguments[e])return!1;return!0},pos:function(e){return e instanceof s.vec?this._evalVec(e,i.pos):+e},neg:function(e){return e instanceof s.vec?this._evalVec(e,i.neg):-e},bnot:function(e){return e instanceof s.vec?this._evalVec(e,i.bnot):~e},lnot:function(e){return e instanceof s.vec?this._evalVec(e,i.lnot):!e},mod:function(e,t){return e instanceof s.vec?this._evalVec(e,this._extVec(t,e),i.mod):e-Math.floor(e/t)*t},shl:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.shl):e<<t},shr:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.shr):e>>t},lt:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.lt):e<t},gt:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.gt):t<e},le:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.le):e<=t},ge:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.ge):t<=e},band:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.band):e&t},bxor:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.bxor):e^t},bor:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.bor):e|t},land:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.land):e&&t},lxor:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.lxor):e&&!t||!e&&t},lor:function(e,t){return e instanceof s.vec?this._evalVec(e,t,i.lor):e||t}};e.exports=i}),i.define("runtime/builtins",function(e,t){var s={},r=t("./vector"),o=t("./internal"),n=t("./texture");s.vec=r.vec,s.Vec2=r.Vec2,s.Vec3=r.Vec3,s.Vec4=r.Vec4;var a={radians:function(e){return e instanceof s.vec?o._evalVec(e,a.radians):e/180*Math.PI},degrees:function(e){return e instanceof s.vec?o._evalVec(e,a.degrees):e/Math.PI*180},sin:function(e){return e instanceof s.vec?o._evalVec(e,a.sin):Math.sin(e)},cos:function(e){return e instanceof s.vec?o._evalVec(e,a.cos):Math.cos(e)},tan:function(e){return e instanceof s.vec?o._evalVec(e,a.tan):Math.tan(e)},asin:function(e){return e instanceof s.vec?o._evalVec(e,a.asin):Math.asin(e)},acos:function(e){return e instanceof s.vec?o._evalVec(e,a.acos):Math.acos(e)},atan:function(e,t){return void 0!==t?e instanceof s.vec?o._evalVec(e,t,a.atan):Math.atan2(e,t):e instanceof s.vec?o._evalVec(e,a.atan):Math.atan(e)},pow:function(e,t){return e instanceof s.vec?o._evalVec(e,t,a.pow):Math.pow(e,t)},exp:function(e){return e instanceof s.vec?o._evalVec(e,a.exp):Math.exp(e)},log:function(e){return e instanceof s.vec?o._evalVec(e,a.log):Math.log(e)},exp2:function(e){return e instanceof s.vec?o._evalVec(e,a.exp2):Math.pow(2,e)},log2:function(e){return e instanceof s.vec?o._evalVec(e,a.log2):Math.log(e)/Math.log(2)},sqrt:function(e){return e instanceof s.vec?o._evalVec(e,a.sqrt):Math.sqrt(e)},inversesqrt:function(e){return e instanceof s.vec?o._evalVec(e,a.inversesqrt):1/Math.sqrt(e)},abs:function(e){return e instanceof s.vec?o._evalVec(e,a.abs):0<=e?e:-e},sign:function(e){return e instanceof s.vec?o._evalVec(e,a.sign):0==e?0:0<e?1:-1},floor:function(e){return e instanceof s.vec?o._evalVec(e,a.floor):Math.floor(e)},ceil:function(e){return e instanceof s.vec?o._evalVec(e,a.ceil):Math.ceil(e)},fract:function(e){return e instanceof s.vec?o._evalVec(e,a.fract):e-a.floor(e)},mod:function(e,t){return e instanceof s.vec?o._evalVec(e,o._extVec(t,e),a.mod):e-Math.floor(e/t)*t},min:function(e,t){return e instanceof s.vec?o._evalVec(e,o._extVec(t,e),a.min):Math.min(e,t)},max:function(e,t){return e instanceof s.vec?o._evalVec(e,o._extVec(t,e),a.max):Math.max(e,t)},clamp:function(e,t,r){if(r<t)throw new Error("clamp(): maxVal must be larger than minVal.");return e instanceof s.vec?o._evalVec(e,o._extVec(t,e),o._extVec(r,e),a.clamp):a.min(a.max(e,t),r)},mix:function(e,t,r){return e instanceof s.vec?o._evalVec(e,t,o._extVec(r,e),a.mix):r*e+(1-r)*t},step:function(e,t){return t instanceof s.vec?o._evalVec(o._extVec(e,t),t,a.step):t<e?0:1},smoothstep:function(e,t,r){if(r instanceof s.vec)return o._evalVec(o._extVec(e,r),o._extVec(t,r),r,a.smoothstep);var n=a.clamp((r-e)/(t-e),0,1);return n*n*(3-2*n)},length:function(e){return o._checkNumber(e)?Math.abs(e):o._op_check(e)?e.length():null},distance:function(e,t){if(o._checkNumber(e,t))return Math.abs(e-t);if(!o._op_check(e,t))return null;var r=s.vec(e).subtract(t);return a.length(r)},dot:function(e,t){return o._checkNumber(e,t)?e*t:o._op_check(e,t)?e.dot(t):null},cross:function(e,t){if(3!=e.dimensions())throw new Error("cross(): parameters x and y must have 3 dimensions.");return o._op_check(e,t)?s.Vec3(e).cross(t):null},normalize:function(e){return o._checkNumber(e)?0==e?e:e/Math.abs(e):o._op_check(e)?e.normalize():null},faceforward:function(e,t,r){return o._op_check(t,e,r)?(a.dot(r,t)<0?s.vec(e):s.vec(e).negate()).cast():null},reflect:function(e,t){if(!o._op_check(e,t))return null;var r=2*a.dot(e,t);return s.vec(e).subtract(s.vec(t).multiply(r)).cast()},refract:function(e,t,r){if(!o._op_check(e,t))return null;var n=1-r*r*(1-a.dot(e,t)*a.dot(e,t));if(n<0)return s.vec(e).subtract(e);var i=r*a.dot(e,t)+Math.sqrt(n);return s.vec(e).multiply(r).subtract(s.vec(t).multiply(i)).cast()},matrixCompMult:function(e,t){return e.matrixCompMult(t)},lessThan:function(e,t){return o._compare(e,t,"<")},lessThanEqual:function(e,t){return o._compare(e,t,"<=")},greaterThan:function(e,t){return o._compare(e,t,">")},greaterThanEqual:function(e,t){return o._compare(e,t,">=")},equal:function(e,t){return o._compare(e,t,"==")},notEqual:function(e,t){return o._compare(e,t,"!=")},any:function(e){for(var t=0;t<e.dimensions();t++)if(e.get(t))return!0;return!1},all:function(e){for(var t=0;t<e.dimensions();t++)if(!e.get(t))return!1;return!0},not:function(e){for(var t=s.vec(e),r=0;r<e.dimensions();r++)t.set(r,e.get(r)?0:1);return t},texture2DLod:function(e,t,r){return n.texture2D(e,t,r)},texture2DProjLod:function(e,t,r){return n.texture2DProj(e,t,r)},textureCubeLod:function(e,t,r){return n.textureCube(e,t,r)},texture2D:function(e,t){return 3==arguments.length?n.texture2D(e,t,arguments[2]):n.texture2D(e,t)},texture2DProj:function(e,t){return 3==arguments.length?n.texture2DProj(e,t,arguments[2]):n.texture2DProj(e,t)},textureCube:function(e,t){return 3==arguments.length?n.textureCube(e,t,arguments[2]):n.textureCube(e,t)}};e.exports=a}),i.define("runtime/ops",function(e,t){var i={};i.vec=t("./vector").vec,i.mat=t("./matrix").mat,r=t("./builtins");var r=t("./internal");Operations={op_pos:function(e){return r.pos(e)},op_neg:function(e){return r.neg(e)},op_bnot:function(e){return r.bnot(e)},op_lnot:function(e){return r.lnot(e)},op_eq:function(e,t){return e instanceof i.vec&&t instanceof i.vec||e instanceof i.mat&&t instanceof i.mat?e.equal(t):"Object"!=typeof e&&"Object"!=typeof rjs&&e==t},op_neq:function(e,t){return!this.op_eq(e,t)},op_mul:function(e,t){var r=!(e instanceof i.vec||e instanceof i.mat),n=!(t instanceof i.vec||t instanceof i.mat);return r&&n?e*t:r?t.multiply(e):e.multiply(t)},op_div:function(e,t){if(e instanceof i.vec&&t instanceof i.mat)throw new Error("op_div cannot handle vec / mat");if(e instanceof i.mat&&t instanceof i.vec)throw new Error("op_div cannot handle mat / vec");return e instanceof i.vec||e instanceof i.mat?e.divide(t):t instanceof i.vec||t instanceof i.mat?t.divide(e):e/t},op_mod:function(e,t){return r.mod(e,t)},op_add:function(e,t){if(e instanceof i.vec&&t instanceof i.mat)throw new Error("op_add cannot handle vec + mat");if(e instanceof i.mat&&t instanceof i.vec)throw new Error("op_add cannot handle mat + vec");return e instanceof i.vec||e instanceof i.mat?e.add(t):t instanceof i.vec||t instanceof i.mat?t.add(e):e+t},op_sub:function(e,t){if(e instanceof i.vec&&t instanceof i.mat)throw new Error("op_sub cannot handle vec - mat");if(e instanceof i.mat&&t instanceof i.vec)throw new Error("op_sub cannot handle mat - vec");return e instanceof i.vec||e instanceof i.mat?e.subtract(t):t instanceof i.vec||t instanceof i.mat?t.subtract(e):e-t},op_shl:function(e,t){return r.shl(e,t)},op_shr:function(e,t){return r.shr(e,t)},op_lt:function(e,t){return r.lt(e,t)},op_gt:function(e,t){return r.gt(e,t)},op_le:function(e,t){return r.le(e,t)},op_ge:function(e,t){return r.ge(e,t)},op_band:function(e,t){return r.band(e,t)},op_bxor:function(e,t){return r.bxor(e,t)},op_bor:function(e,t){return r.bor(e,t)},op_land:function(e,t){return r.land(e,t)},op_lxor:function(e,t){return r.lxor(e,t)},op_lor:function(e,t){return r.lor(e,t)}},e.exports=Operations}),i.define("runtime/environment",function(e,t){(GLSL={}).Object=t("../events").Object,GLSL.Environment=function(){GLSL.Object.call(this),this._data={},this._debugHooks=[],this._editScopeLevel=0,this._runScopeLevel=0},GLSL.Environment.Event={InputChanged:"environment-input-changed",ResultChanged:"environment-result-changed"},GLSL.Environment.prototype={constructor:GLSL.Environment,__proto__:GLSL.Object.prototype,get:function(e){return this._data[e]},set:function(e,t){if(console.assert(this._editScopeLevel||this._runScopeLevel,this),!this._editScopeLevel&&!this._runScopeLevel)throw new Error("Tried to set variable "+e+" while not in a edit or run scope!");this._data[e]=t},clone:function(){var e=new GLSL.Environment;for(var t in e.enterEditScope(),this._data)e.set(t,this.get(t));return e.exitEditScope(),e},reset:function(){this._data={}},enterEditScope:function(){console.assert(!this._runScopeLevel,this._runScopeLevel),++this._editScopeLevel},exitEditScope:function(){console.assert(0<this._editScopeLevel,this._editScopeLevel),--this._editScopeLevel,this._editScopeLevel||this.dispatchEventToListeners(GLSL.Environment.Event.InputChanged)},enterRunScope:function(){console.assert(!this._editScopeLevel,this._editScopeLevel),++this._runScopeLevel},exitRunScope:function(){console.assert(!this._editScopeLevel,this._editScopeLevel),console.assert(0<this._runScopeLevel,this._runScopeLevel),--this._runScopeLevel,this._runScopeLevel||this.dispatchEventToListeners(GLSL.Environment.Event.ResultChanged)},get debugHooks(){return this._debugHooks.slice()},clearDebugHooks:function(){this._debugHooks=[]},addDebugHook:function(e,t,r,n){},validateForShader:function(e){return!0},setDefaultValuesForShader:function(e,n){function t(e,t){var r=null;if(n instanceof Function&&(r=n(t)),!r)switch(t.type){case"float":r=1;break;case"bool":r=!0;break;case"vec2":r=GLSL.Runtime.Vec2(1,1);break;case"vec3":r=GLSL.Runtime.Vec3(1,1,1);break;case"vec4":r=GLSL.Runtime.Vec4(1,1,1,1);break;case"mat2":r=GLSL.Runtime.Mat2(1,1,1,1);break;case"mat3":r=GLSL.Runtime.Mat3(1,1,1,1,1,1,1,1,1);break;case"mat4":r=GLSL.Runtime.Mat4(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)}e.set(t.name,r)}e&&(console.assert(e instanceof GLSL.Shader,e),this.enterEditScope(),e.uniforms.map(t.bind(null,env)),e.attributes.map(t.bind(null,env)),e.type===GLSL.Shader.Type.Fragment&&e.varyings.map(t.bind(null,env)),this.exitEditScope())}},e.exports=GLSL.Environment}),i.define("runtime",function(e,t){var r={},n=t("./runtime/vector");r.vec=n.vec,r.Vec2=n.Vec2,r.Vec3=n.Vec3,r.Vec4=n.Vec4;var i=t("./runtime/matrix");r.mat=i.mat,r.Mat2=i.Mat2,r.Mat3=i.Mat3,r.Mat4=i.Mat4;var s=t("./runtime/builtins"),o=t("./runtime/ops"),a=t("./runtime/access"),c=t("./runtime/texture");for(var u in o)r[u]=o[u];for(var u in s)r[u]=s[u];for(var u in a)r[u]=a[u];for(var u in c)r[u]=c[u];e.exports=r}),i.define("compiler/ast",function(e,t){ASTNode=function(e,t,r){for(var n in this.type=e,this.position=t,r)r.hasOwnProperty(n)&&(this[n]=r[n])},ASTNode.__nextId=1,ASTNode.Types={Program:"root",Preprocessor:"preprocessor",MacroCall:"macro_call",FunctionCall:"function_call",FunctionPrototype:"function_prototype",FunctionDeclaration:"function_declaration",Scope:"scope",IfStatement:"if_statement",ForStatement:"for_statement",WhileStatement:"while_statement",DoStatement:"do_statement",ReturnStatement:"return",ContinueStatement:"continue",BreakStatement:"break",DiscardStatement:"discard",ExpressionStatement:"expression",Declarator:"declarator",DeclaratorItem:"declarator_item",Invariant:"invariant",Precision:"precision",Parameter:"parameter",StructDefinition:"struct_definition",Type:"type",IntegerLiteral:"int",FloatLiteral:"float",BooleanLiteral:"bool",Identifier:"identifier",Operator:"operator",PostfixExpression:"postfix",UnaryExpression:"unary",BinaryExpression:"binary",TernaryExpression:"ternary",IndexSelector:"accessor",FieldSelector:"field_selector"},e.exports=ASTNode}),i.define("compiler/visitor",function(e,t){ASTVisitor=function(e){for(key in this._callbacks=e||{},this._callbacks)console.assert("undefined"!==key,"Visitor callback provided for node type 'undefined'. This is a bug. Function text: "+this._callbacks[key].toString())},ASTVisitor.prototype={constructor:ASTVisitor,visitorForType:function(e){return e in this._callbacks?this._callbacks[e]:this.defaultVisitor},visitNode:function(e){if(e&&e.type)return this.visitorForType(e.type).call(this,e)},visitList:function(e){if(e instanceof Array&&e.length){for(var t=[],r=0;r<e.length;++r)t.push(this.visitNode(e[r]));return t}},defaultVisitor:function(e){for(var t in e){var r=e[t];r instanceof Array?this.visitList(r):r instanceof Object&&r.type&&this.visitNode(r)}}},e.exports=ASTVisitor}),i.define("compiler/typecheck",function(e,t){var r={Typechecker:function(e){}};r.Typechecker.prototype={constructor:r.Typechecker,typecheck:function(){return!0}},e.exports=r.Typechecker}),i.define("compiler/pretty",function(e,t){var r=t("./visitor");PrettyPrinter=function(){r.call(this),this._scopes=[],this._currentIndent=""},PrettyPrinter.prototype={constructor:PrettyPrinter,__proto__:r.prototype,formattedText:function(e){return this._lines=[],this.visitNode(e),this._lines.join("\n")},visitorForType:function(e){return e in PrettyPrinter.Callbacks?PrettyPrinter.Callbacks[e]:r.prototype.visitorForType(e)},_addLine:function(e){this._lines.push([this._currentIndent,e].join(""))},_increaseIndent:function(){var e=this._currentIndent;return this._currentIndent=[this._currentIndent,PrettyPrinter.IndentString].join(""),e}},PrettyPrinter.IndentString="    ",PrettyPrinter.Callbacks={},PrettyPrinter.Callbacks[ASTNode.Types.Identifier]=function(e){return e.name},PrettyPrinter.Callbacks[ASTNode.Types.Program]=function(e){this.visitList(e.statements)},PrettyPrinter.Callbacks[ASTNode.Types.Preprocessor]=function(e){if("#define"===e.directive){var t=[e.directive," ",e.identifier];e.parameters&&t.push("("+e.parameters.join(", ")+")"),e.token_string&&(t.push(" "),t.push(e.token_string)),this._addLine(t.join(""))}else{("#elif"===e.directive||"#else"===e.directive)&&"#endif"===this._lines[this._lines.length-1]&&this._lines.pop(),this._addLine(e.directive+" "+e.value),this.visitList(e.guarded_statements),this._addLine("#endif")}},PrettyPrinter.Callbacks[ASTNode.Types.MacroCall]=function(e){return e.macro_name+"("+e.paremeters.join(", ")+")"},PrettyPrinter.Callbacks[ASTNode.Types.FunctionCall]=function(e){var t=this.visitList(e.parameters)||[];return e.function_name+"("+t.join(", ")+")"},PrettyPrinter.Callbacks[ASTNode.Types.FunctionDeclaration]=function(e){var t=this.visitNode(e.returnType),r=this.visitList(e.parameters)||["void"];this._addLine(""),this._addLine(t+" "+e.name+"("+r.join(", ")+") {");var n=this._increaseIndent();this.visitNode(e.body),this._currentIndent=n,this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.FunctionPrototype]=function(e){var t=this.visitNode(e.returnType),r=this.visitList(e.parameters)||["void"];this._addLine(""),this._addLine(t+" "+e.name+"("+r.join(", ")+");")},PrettyPrinter.Callbacks[ASTNode.Types.Scope]=function(e){this._scopes.push(e),this.visitList(e.statements),this._scopes.pop(e)},PrettyPrinter.Callbacks[ASTNode.Types.IfStatement]=function(e){this._addLine("if ("+this.visitNode(e.condition)+") {");var t=this._increaseIndent();if(this.visitNode(e.body),this._currentIndent=t,e.elseBody){this._addLine("} else {");t=this._increaseIndent();this.visitNode(e.elseBody),this._currentIndent=t}this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.ForStatement]=function(e){var t="";e.initializer&&(this.visitNode(e.initializer),t=(t=this._lines.pop().trim()).substr(0,t.length-1));var r=this.visitNode(e.condition)||"",n=this.visitNode(e.increment)||"";this._addLine("for ("+[t,r,n].join("; ")+") {");var i=this._increaseIndent();this.visitNode(e.body),this._currentIndent=i,this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.WhileStatement]=function(e){this._addLine("while ("+this.visitNode(e.condition)+") {");var t=this._increaseIndent();this.visitNode(e.body),this._currentIndent=t,this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.DoStatement]=function(e){this._addLine("do {");var t=this._increaseIndent();this.visitNode(e.body),this._currentIndent=t,this._addLine("} while ("+this.visitNode(e.condition)+");")},PrettyPrinter.Callbacks[ASTNode.Types.ReturnStatement]=function(e){e.value?this._addLine("return "+this.visitNode(e.value)+";"):this._addLine("return;")},PrettyPrinter.Callbacks[ASTNode.Types.ContinueStatement]=function(e){this._addLine("continue;")},PrettyPrinter.Callbacks[ASTNode.Types.BreakStatement]=function(e){this._addLine("break;")},PrettyPrinter.Callbacks[ASTNode.Types.DiscardStatement]=function(e){this._addLine("discard;")},PrettyPrinter.Callbacks[ASTNode.Types.ExpressionStatement]=function(e){this._addLine(this.visitNode(e.expression)+";")},PrettyPrinter.Callbacks[ASTNode.Types.Declarator]=function(e){var t=this.visitNode(e.typeAttribute),r=this.visitList(e.declarators);this._addLine(t+" "+r.join(", ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.DeclaratorItem]=function(e){var t=[this.visitNode(e.name)];return e.initializer&&(t.push("="),t.push(this.visitNode(e.initializer))),t.join(" ")},PrettyPrinter.Callbacks[ASTNode.Types.Invariant]=function(e){this._addLine("invariant "+this.visitList(e.identifiers).join(", ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.Precision]=function(e){return this._addLine(["precision",e.precision,e.typeName].join(" ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.Parameter]=function(e){var t=[e.type_name,e.name];e.precision&&t.unshift(e.precision),e.parameterQualifier&&t.unshift(e.parameterQualifier),e.typeQualifier&&t.unshift(e.typeQualifier);var r=t.join(" ");return e.arraySize&&(r=r+"["+this.visit(e.arraySize)+"]"),r},PrettyPrinter.Callbacks[ASTNode.Types.StructDefinition]=function(e){var t=["struct"];e.qualifier&&t.unshift(e.qualifier),e.name&&t.push(e.name),t.push("{"),this._addLine(t.join(" "));var r=this._increaseIndent();if(this.visitList(e.members),this._currentIndent=r,e.declarators){var n=this.visitList(e.declarators);this._addLine("} "+n.join(", ")+";")}else this._addLine("};")},PrettyPrinter.Callbacks[ASTNode.Types.Type]=function(e){var t=[e.name];return e.precision&&t.unshift(e.precision),e.qualifier&&t.unshift(e.qualifier),t.join(" ")},PrettyPrinter.Callbacks[ASTNode.Types.IntegerLiteral]=function(e){return e.value},PrettyPrinter.Callbacks[ASTNode.Types.FloatLiteral]=function(e){return e.value},PrettyPrinter.Callbacks[ASTNode.Types.BooleanLiteral]=function(e){return e.value},PrettyPrinter.Callbacks[ASTNode.Types.Operator]=function(e){return e.operator},PrettyPrinter.Callbacks[ASTNode.Types.PostfixExpression]=function(e){return this.visitNode(e.expression)+this.visitNode(e.operator)},PrettyPrinter.Callbacks[ASTNode.Types.UnaryExpression]=function(e){return this.visitNode(e.operator)+this.visitNode(e.expression)},PrettyPrinter.Callbacks[ASTNode.Types.BinaryExpression]=function(e){var t=[this.visitNode(e.left),this.visitNode(e.operator),this.visitNode(e.right)].join(" "),r=e.operator.operator;return-1===r.indexOf("==")&&-1!==r.indexOf("=")?t:"("+t+")"},PrettyPrinter.Callbacks[ASTNode.Types.TernaryExpression]=function(e){return[this.visitNode(e.condition),"?",this.visitNode(e.is_true),":",this.visitNode(e.is_false)].join(" ")},PrettyPrinter.Callbacks[ASTNode.Types.IndexSelector]=function(e){return"["+this.visitNode(e.index)+"]"},PrettyPrinter.Callbacks[ASTNode.Types.FieldSelector]=function(e){return"."+e.selection},e.exports=PrettyPrinter}),i.define("compiler/codegen",function(e,t){function r(e){n.call(this),this._shader=e,this._currentIndent="",this._withinFunctionScope=null,this._globalVariableNames=new Set;for(var t=e.uniforms,r=0;r<t.length;++r)this._globalVariableNames.add(t[r].name);for(t=e.varyings,r=0;r<t.length;++r)this._globalVariableNames.add(t[r].name);for(t=e.attributes,r=0;r<t.length;++r)this._globalVariableNames.add(t[r].name)}var n=t("./visitor"),i=t("../runtime/builtins"),s=t("../runtime/ops");r.ConstructorMap={vec2:"Vec2",vec3:"Vec3",vec4:"Vec4",mat2:"Mat2",mat3:"Mat3",mat4:"Mat4"},r.prototype={constructor:r,__proto__:n.prototype,translateShader:function(){this._lines=[],this._addLine(""),this._addLine("var RT = GLSL.Runtime;"),this._addLine(""),this.visitNode(this._shader.ast),this._addLine(""),this._shader.shouldEmitDebuggerStatement&&this._addLine("debugger;"),this._addLine(this._resolveFunction("main")+"();"),this._addLine("");var t={};try{t.code=new Function("GLSL","env",this._lines.join("\n"))}catch(e){t.source="function(GLSL, env) {\n"+this._lines.join("\n")+"}",t.error=e.message}return t},visitorForType:function(e){return e in r.Callbacks?r.Callbacks[e]:n.prototype.visitorForType.call(this,e)},_resolveGetLocal:function(e){return console.assert("string"==typeof e,e),this._resolveGetName(e)},_resolveFunction:function(e){return console.assert("string"==typeof e,e),e in i||e in s?"RT."+e:e in r.ConstructorMap?"RT."+r.ConstructorMap[e]:this._resolveGetName(e)},_resolveGetName:function(e){return console.assert("string"==typeof e,e),this._globalVariableNames.has(e)?"env.get('"+e+"')":"$"+e},_resolveSetName:function(e,t){return console.assert("string"==typeof e,e),this._globalVariableNames.has(e)?"env.set('"+e+"', "+t+")":"$"+e+" = "+t},_addLine:function(e){this._lines.push([this._currentIndent,e].join(""))},_increaseIndent:function(){var e=this._currentIndent;return this._currentIndent=[this._currentIndent,r.IndentString].join(""),e}},r.IndentString="    ",(r.Callbacks={})[ASTNode.Types.Program]=function(e){this.visitList(e.statements)},r.Callbacks[ASTNode.Types.Preprocessor]=function(e){},r.Callbacks[ASTNode.Types.MacroCall]=function(e){},r.Callbacks[ASTNode.Types.FunctionCall]=function(e){var t=this.visitList(e.parameters)||[];return this._resolveFunction(e.function_name)+"("+t.join(", ")+")"},r.Callbacks[ASTNode.Types.FunctionPrototype]=function(e){},r.Callbacks[ASTNode.Types.FunctionDeclaration]=function(e){var t=this.visitList(e.parameters)||[];t=t.map(function(e){return this._resolveGetLocal(e)},this),this._withinFunctionScope=e,this._addLine("var "+this._resolveGetLocal(e.name)+" = function("+t.join(", ")+") {");var r=this._increaseIndent();this.visitNode(e.body),this._currentIndent=r,this._addLine("};"),delete this._withinFunctionScope},r.Callbacks[ASTNode.Types.Scope]=function(e){this.visitList(e.statements)},r.Callbacks[ASTNode.Types.IfStatement]=function(e){var t=this.visitNode(e.condition);this._addLine("if ("+t+") {");var r=this._increaseIndent();if(this.visitNode(e.body),this._currentIndent=r,e.elseBody){this._addLine("} else {");r=this._increaseIndent();this.visitNode(e.elseBody),this._currentIndent=r}this._addLine("}")},r.Callbacks[ASTNode.Types.ForStatement]=function(e){this.visitNode(e.initializer);var t=this.visitNode(e.condition)||"true",r=this.visitNode(e.increment);this._addLine("while ("+t+") {");var n=this._increaseIndent();this.visitNode(e.body),r&&this._addLine(r+";"),this._currentIndent=n,this._addLine("}")},r.Callbacks[ASTNode.Types.WhileStatement]=function(e){var t=this.visitNode(e.condition);this._addLine("while ("+t+") {");var r=this._increaseIndent();this.visitNode(e.body),this._currentIndent=r,this._addLine("}")},r.Callbacks[ASTNode.Types.DoStatement]=function(e){var t=this.visitNode(e.condition);this._addLine("do {");var r=this._increaseIndent();this.visitNode(e.body),this._currentIndent=r,this._addLine("} while ("+t+");")},r.Callbacks[ASTNode.Types.ReturnStatement]=function(e){e.value?this._addLine("return "+this.visitNode(e.value)+";"):this._addLine("return;")},r.Callbacks[ASTNode.Types.ContinueStatement]=function(e){this._addLine("continue;")},r.Callbacks[ASTNode.Types.BreakStatement]=function(e){this._addLine("break;")},r.Callbacks[ASTNode.Types.DiscardStatement]=function(e){this._addLine("discard;")},r.Callbacks[ASTNode.Types.ExpressionStatement]=function(e){this._addLine(this.visitNode(e.expression)+";")},r.Callbacks[ASTNode.Types.Declarator]=function(e){this._withinFunctionScope&&this.visitList(e.declarators)},r.Callbacks[ASTNode.Types.DeclaratorItem]=function(e){var t=this.visitNode(e.name);e.initializer?this._addLine("var "+t+" = "+this.visitNode(e.initializer)+";"):this._addLine("var "+t+";")},r.Callbacks[ASTNode.Types.Invariant]=function(e){},r.Callbacks[ASTNode.Types.Precision]=function(e){},r.Callbacks[ASTNode.Types.Parameter]=function(e){return e.name},r.Callbacks[ASTNode.Types.StructDefinition]=function(e){},r.Callbacks[ASTNode.Types.Type]=function(e){},r.Callbacks[ASTNode.Types.IntegerLiteral]=function(e){return Number(e.value)},r.Callbacks[ASTNode.Types.FloatLiteral]=function(e){return Number(e.value)},r.Callbacks[ASTNode.Types.BooleanLiteral]=function(e){return e.value?"true":"false"},r.Callbacks[ASTNode.Types.Identifier]=function(e){return this._resolveGetName(e.name)},r.Callbacks[ASTNode.Types.Operator]=function(e){return e.operator},r.Callbacks[ASTNode.Types.PostfixExpression]=function(e){var t=this.visitNode(e.operator),r=this.visitNode(e.expression),n=new SelectorBuilder(e),i=n.params.slice(),s=null;switch(t){case"++":s="op_add";break;case"--":s="op_sub";break;default:return i.unshift(this._resolveGetName(n.operand)),"RT.get("+i.join(", ")+")"}var o=s?this._resolveFunction(s)+"("+r+", 1.0)":"/* "+t+" */"+r;return(i=n.params.slice()).unshift(this._resolveGetLocal(n.operand)),i.push(o),n.params.length?this._resolveSetName(n.operand,"RT.set("+i.join(", ")+")"):this._resolveSetName(n.operand,o)},r.Callbacks[ASTNode.Types.UnaryExpression]=function(e){var t=this.visitNode(e.operator),r=this.visitNode(e.expression),n=null;switch(t){case"+":n="op_pos";break;case"-":n="op_neg";break;case"~":n="op_bnot";break;case"!":n="op_lnot";break;default:return"/* "+t+" */"+r}return n?this._resolveFunction(n)+"("+r+")":"/* "+t+" */"+r},r.Callbacks[ASTNode.Types.BinaryExpression]=function(e){var t=this.visitNode(e.operator),r=this.visitNode(e.left),n=this.visitNode(e.right),i=null,s=!1;switch(t){case"==":i="op_eq";break;case"!=":i="op_neq";break;case"*":i="op_mul";break;case"/":i="op_div";break;case"%":i="op_mod";break;case"+":i="op_add";break;case"-":i="op_sub";break;case"<<":i="op_shl";break;case">>":i="op_shr";break;case"<":i="op_lt";break;case">":i="op_gt";break;case"<=":i="op_le";break;case">=":i="op_ge";break;case"&":i="op_band";break;case"^":i="op_bxor";break;case"|":i="op_bor";break;case"&&":i="op_land";break;case"^^":i="op_lxor";break;case"||":i="op_lor";break;case"=":s=!0;break;case"+=":i="op_add",s=!0;break;case"-=":i="op_sub",s=!0;break;case"*=":i="op_mul",s=!0;break;case"/=":i="op_div",s=!0;break;case"%=":i="op_mod",s=!0;break;case"<<=":i="op_shl",s=!0;break;case">>=":i="op_shr",s=!0;break;case"&=":i="op_band",s=!0;break;case"^=":i="op_bxor",s=!0;break;case"|=":i="op_bor",s=!0;break;default:return r+" /* "+t+" */ "+n}var o=i?this._resolveFunction(i)+"("+r+", "+n+")":n;if(s){var a=new SelectorBuilder(e.left),c=a.params.slice();return c.unshift(this._resolveGetLocal(a.operand)),c.push(o),a.params.length?this._resolveSetName(a.operand,"RT.set("+c.join(", ")+")"):this._resolveSetName(a.operand,o)}return o},r.Callbacks[ASTNode.Types.TernaryExpression]=function(e){return"("+this.visitNode(e.condition)+") "+this.visitNode(e.is_true)+" : "+this.visitNode(e.is_false)},r.Callbacks[ASTNode.Types.IndexSelector]=function(e){},r.Callbacks[ASTNode.Types.FieldSelector]=function(e){},SelectorBuilder=function(e){n.call(this),this.operand=null,this.params=[],this.visitNode(e)},SelectorBuilder.prototype={constructor:SelectorBuilder,__proto__:n.prototype,visitorForType:function(e){if(e in SelectorBuilder.Callbacks)return SelectorBuilder.Callbacks[e];throw new Error("Unexpected AST node encountered by selector builder.")}},SelectorBuilder.Callbacks={},SelectorBuilder.Callbacks[ASTNode.Types.IntegerLiteral]=function(e){return this.params.push(e.value)},SelectorBuilder.Callbacks[ASTNode.Types.FloatLiteral]=function(e){return this.params.push(e.value)},SelectorBuilder.Callbacks[ASTNode.Types.Identifier]=function(e){return this.operand=e.name},SelectorBuilder.Callbacks[ASTNode.Types.Operator]=function(e){e.operator instanceof ASTNode&&this.visitNode(e.operator)},SelectorBuilder.Callbacks[ASTNode.Types.PostfixExpression]=function(e){this.visitNode(e.expression),this.visitNode(e.operator)},SelectorBuilder.Callbacks[ASTNode.Types.IndexSelector]=function(e){this.visitNode(e.index)},SelectorBuilder.Callbacks[ASTNode.Types.FieldSelector]=function(e){this.params.push("'"+e.selection+"'")},e.exports=r}),i.define("compiler/parser",function(e,Qo){function Zo(e,t,r,n,i,s){this.message=e,this.expected=t,this.found=r,this.offset=n,this.line=i,this.column=s,this.name="SyntaxError"}function t(){this.constructor=r}var r,n;e.exports=(r=Zo,n=Error,t.prototype=n.prototype,r.prototype=new t,{SyntaxError:Zo,parse:function(d){var e,t=1<arguments.length?arguments[1]:{},p={},r={start:us},n=us,f=p,u=void 0,i=/^[\n]/,s={type:"class",value:"[\\n]",description:"[\\n]"},o=function(){return"\n"},a={type:"any",description:"any character"},c={type:"other",description:"whitespace"},l=/^[\\\n]/,h={type:"class",value:"[\\\\\\n]",description:"[\\\\\\n]"},v=/^[\r\t\f\x0B ]/,m={type:"class",value:"[\\r\\t\\f\\x0B ]",description:"[\\r\\t\\f\\x0B ]"},y="/*",_={type:"literal",value:"/*",description:'"/*"'},b="*/",g={type:"literal",value:"*/",description:'"*/"'},S="//",A={type:"literal",value:"//",description:'"//"'},T=/^[^\n]/,x={type:"class",value:"[^\\n]",description:"[^\\n]"},k={type:"other",description:"comment"},C=null,w=";",L={type:"literal",value:";",description:'";"'},N=",",V={type:"literal",value:",",description:'","'},E="[",P={type:"literal",value:"[",description:'"["'},F="]",R={type:"literal",value:"]",description:'"]"'},j="=",M={type:"literal",value:"=",description:'"="'},I="(",O={type:"literal",value:"(",description:'"("'},q=")",D={type:"literal",value:")",description:'")"'},B="{",G={type:"literal",value:"{",description:'"{"'},z="}",U={type:"literal",value:"}",description:'"}"'},Q=function(e){for(var t=new Uo({type:"root",statements:[]}),r=0;r<e.length;r++)e[r]&&(t.statements=t.statements.concat(e[r]));return t},Z=function(e){return e},W=function(){return""},H="#",$={type:"literal",value:"#",description:'"#"'},X="undef",J={type:"literal",value:"undef",description:'"undef"'},K="pragma",Y={type:"literal",value:"pragma",description:'"pragma"'},ee="version",te={type:"literal",value:"version",description:'"version"'},re="error",ne={type:"literal",value:"error",description:'"error"'},ie="extension",se={type:"literal",value:"extension",description:'"extension"'},oe="line",ae={type:"literal",value:"line",description:'"line"'},ce=function(e){return e.join("")},ue=function(e,t){return new Uo({type:"preprocessor",directive:"#"+e,value:t})},le=/^[A-Za-z_]/,he={type:"class",value:"[A-Za-z_]",description:"[A-Za-z_]"},de=/^[A-Za-z_0-9]/,pe={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},fe=function(e,t){return new Uo({type:"identifier",name:e+t.join("")})},ve=function(e,t){return e?[e].concat(t.map(function(e){return e[1]})):[]},me=function(e,t){var r=new Uo({type:"macro_call",macro_name:e,parameters:t});return t||(r.parameters=[]),r},ye="define",_e={type:"literal",value:"define",description:'"define"'},be=/^[ \t]/,ge={type:"class",value:"[ \\t]",description:"[ \\t]"},Se=function(e,t,r){return new Uo({type:"preprocessor",directive:"#define",identifier:e.name,token_string:r,parameters:t||null})},Ae="ifdef",Te={type:"literal",value:"ifdef",description:'"ifdef"'},xe="ifndef",ke={type:"literal",value:"ifndef",description:'"ifndef"'},Ce="if",we={type:"literal",value:"if",description:'"if"'},Le=function(e,t){return new Uo({type:"preprocessor",directive:"#"+e,value:t})},Ne="elif",Ve={type:"literal",value:"elif",description:'"elif"'},Ee=function(e){return new Uo({type:"preprocessor",directive:"#elif",value:e})},Pe="else",Fe={type:"literal",value:"else",description:'"else"'},Re=function(){return new Uo({type:"preprocessor",directive:"#else"})},je="endif",Me={type:"literal",value:"endif",description:'"endif"'},Ie=function(e,t,r){return function(e,t,r){var n=t;r&&(n=n.concat([r]));var i=e[0];i.guarded_statements=e[1].statements;for(var s=i,o=0;o<n.length;o++)s.elseBody=n[o][0],s.elseBody.guarded_statements=n[o][1].statements,s=s.elseBody;return i}(e,t,r)},Oe=function(e,t){return result=new Uo({type:"function_declaration",name:e.name,returnType:e.returnType,parameters:e.parameters,body:t}),result},qe=function(e){return result=new Uo({type:"scope",statements:[]}),e&&e.statements&&(result.statements=e.statements),result},De=function(e){return{statements:e}},Be=function(e){return e},Ge=function(e,t,r){return result=new Uo({type:"if_statement",condition:e,body:t}),r&&(result.elseBody=r[2]),result},ze="for",Ue={type:"literal",value:"for",description:'"for"'},Qe=function(e,t,r,n){return new Uo({type:"for_statement",initializer:e,condition:t,increment:r,body:n})},Ze="while",We={type:"literal",value:"while",description:'"while"'},He=function(e){return{condition:e}},$e=function(e,t){return new Uo({type:"while_statement",condition:e.condition,body:t})},Xe="do",Je={type:"literal",value:"do",description:'"do"'},Ke=function(e,t){return new Uo({type:"do_statement",condition:t.condition,body:e})},Ye="return",et={type:"literal",value:"return",description:'"return"'},tt=function(e){return new Uo({type:"return",value:e})},rt="continue",nt={type:"literal",value:"continue",description:'"continue"'},it="break",st={type:"literal",value:"break",description:'"break"'},ot=function(){return"fs"==Bo},at="discard",ct={type:"literal",value:"discard",description:'"discard"'},ut=function(){return"discard"},lt=function(e){return new Uo({type:e[0]})},ht=function(e){return new Uo({type:"expression",expression:e})},dt={type:"other",description:"declaration"},pt=function(e){return e},ft=function(e,t){return new Uo({type:"declarator",typeAttribute:e,declarators:t})},vt=function(){return"vs"==Bo},mt="invariant",yt={type:"literal",value:"invariant",description:'"invariant"'},_t=function(e,t){return new Uo({type:"invariant",identifiers:[e].concat(t.map(function(e){return e[1]}))})},bt="precision",gt={type:"literal",value:"precision",description:'"precision"'},St=function(e,t){return new Uo({type:"precision",precision:e,typeName:t})},At=function(e,t){return new Uo({type:"declarator",typeAttribute:e,declarators:t})},Tt="void",xt={type:"literal",value:"void",description:'"void"'},kt=function(e,t){return[e].concat(t.map(function(e){return e[1]}))},Ct=function(e,t,r){return result=new Uo({type:"function_prototype",name:t.name,returnType:e,parameters:r}),"void"!=r&&r||(result.parameters=[]),result},wt="inout",Lt={type:"literal",value:"inout",description:'"inout"'},Nt="in",Vt={type:"literal",value:"in",description:'"in"'},Et="out",Pt={type:"literal",value:"out",description:'"out"'},Ft=function(e,t,r,n,i,s){var o=new Uo({type:"parameter",type_name:n,name:i.name});return e&&(o.typeQualifier=e[0]),t&&(o.parameterQualifier=t[0]),r&&(o.precision=r[0]),s&&(o.arraySize=s[1]),o.typeQualifier&&o.parameterQualifier&&"in"!=o.parameterQualifier?null:o},Rt=function(e,t){return[e].concat(t.map(function(e){return e[1]}))},jt=function(e){return new Uo({type:"declarator_item",name:e})},Mt=function(e,t){return new Uo({type:"declarator_item",name:e,arraySize:t,isArray:!0})},It=function(e){return new Uo({type:"declarator_item",name:e,isArray:!0})},Ot=function(e,t){return new Uo({type:"declarator_item",name:e,initializer:t})},qt=function(e){return e.map(function(e){return new Uo({type:"declarator",typeAttribute:e[0],declarators:e[2]})})},Dt="struct",Bt={type:"literal",value:"struct",description:'"struct"'},Gt=function(e,t,r,n){var i=new Uo({type:"struct_definition",members:r});return e&&(i.qualifier=e[0]),t&&(i.name=t[1].name,qo[i.name]=i),n&&(i.declarators=n),i},zt=function(e,t){var r=new Uo({type:"type",name:t});return e&&(r.precision=e[0]),r},Ut={type:"other",description:"locally specified type"},Qt=function(e,t){var r=t;return e&&(r.qualifier=e[0]),r},Zt="attribute",Wt={type:"literal",value:"attribute",description:'"attribute"'},Ht=function(){return"attribute"},$t=function(e,t){var r=t;return r.qualifier=e,r},Xt={type:"other",description:"fully specified type"},Jt={type:"other",description:"precision qualifier"},Kt="highp",Yt={type:"literal",value:"highp",description:'"highp"'},er="mediump",tr={type:"literal",value:"mediump",description:'"mediump"'},rr="lowp",nr={type:"literal",value:"lowp",description:'"lowp"'},ir="const",sr={type:"literal",value:"const",description:'"const"'},or={type:"other",description:"type qualifier"},ar="varying",cr={type:"literal",value:"varying",description:'"varying"'},ur=function(){return"invariant varying"},lr="uniform",hr={type:"literal",value:"uniform",description:'"uniform"'},dr={type:"other",description:"void"},pr=function(){return new Uo({type:"type",name:"void"})},fr={type:"other",description:"type name"},vr="float",mr={type:"literal",value:"float",description:'"float"'},yr="int",_r={type:"literal",value:"int",description:'"int"'},br="bool",gr={type:"literal",value:"bool",description:'"bool"'},Sr="sampler2D",Ar={type:"literal",value:"sampler2D",description:'"sampler2D"'},Tr="samplerCube",xr={type:"literal",value:"samplerCube",description:'"samplerCube"'},kr=function(e){return e.name in qo?e.name:null},Cr={type:"other",description:"identifier"},wr=/^[^A-Za-z_0-9]/,Lr={type:"class",value:"[^A-Za-z_0-9]",description:"[^A-Za-z_0-9]"},Nr={type:"other",description:"keyword"},Vr="true",Er={type:"literal",value:"true",description:'"true"'},Pr="false",Fr={type:"literal",value:"false",description:'"false"'},Rr=/^[bi]/,jr={type:"class",value:"[bi]",description:"[bi]"},Mr="vec",Ir={type:"literal",value:"vec",description:'"vec"'},Or=/^[234]/,qr={type:"class",value:"[234]",description:"[234]"},Dr=function(e){return e.join("")},Br="mat",Gr={type:"literal",value:"mat",description:'"mat"'},zr=/^[1-9]/,Ur={type:"class",value:"[1-9]",description:"[1-9]"},Qr=/^[0-9]/,Zr={type:"class",value:"[0-9]",description:"[0-9]"},Wr=function(e,t){return new Uo({type:"int",value:parseInt([e].concat(t).join(""),10)})},Hr="0",$r={type:"literal",value:"0",description:'"0"'},Xr=/^[Xx]/,Jr={type:"class",value:"[Xx]",description:"[Xx]"},Kr=/^[0-9A-Fa-f]/,Yr={type:"class",value:"[0-9A-Fa-f]",description:"[0-9A-Fa-f]"},en=function(e){return new Uo({type:"int",value:parseInt(e.join(""),16)})},tn=/^[0-7]/,rn={type:"class",value:"[0-7]",description:"[0-7]"},nn=function(e){return new Uo({type:"int",value:parseInt(e.join(""),8)})},sn=function(){return new Uo({type:"int",value:0})},on=".",an={type:"literal",value:".",description:'"."'},cn=function(e){return e[0]=e[0].join(""),e[2]=e[2].join(""),new Uo({type:"float",value:parseFloat(e.join(""))})},un=function(e){return new Uo({type:"float",value:parseFloat(e[0].join("")+e[1])})},ln=/^[Ee]/,hn={type:"class",value:"[Ee]",description:"[Ee]"},dn=/^[+\-]/,pn={type:"class",value:"[+\\-]",description:"[+\\-]"},fn=function(e,t){return["e",e].concat(t).join("")},vn=function(e){return e},mn=function(e){return new Uo({type:"bool",value:"true"==e})},yn=function(e){return new Uo({type:"accessor",index:e})},_n=function(e){return new Uo({type:"field_selector",selection:e.name})},bn=function(e,t){for(var r=e,n=0;n<t.length;n++)r=new Uo({type:"postfix",operator:t[n],expression:r});return r},gn="++",Sn={type:"literal",value:"++",description:'"++"'},An="--",Tn={type:"literal",value:"--",description:'"--"'},xn=function(e,t,r){var n=e;t&&(n=new Uo({type:"postfix",operator:new Uo({id:Do++,type:"operator",operator:t}),expression:n}));for(var i=0;i<r.length;i++)n=new Uo({type:"postfix",operator:r[i],expression:n});return n},kn=function(){return[]},Cn=function(e,t){return[e].concat(t.map(function(e){return e[1]}))},wn=function(e,t){var r=new Uo({type:"function_call",function_name:e,parameters:t});return t||(r.parameters=[]),r},Ln=function(e){return e.name},Nn="!",Vn={type:"literal",value:"!",description:'"!"'},En="~",Pn={type:"literal",value:"~",description:'"~"'},Fn="+",Rn={type:"literal",value:"+",description:'"+"'},jn="-",Mn={type:"literal",value:"-",description:'"-"'},In=function(e,t){return result=t,e&&(result=new Uo({type:"unary",expression:result,operator:new Uo({type:"operator",operator:e})})),result},On="*",qn={type:"literal",value:"*",description:'"*"'},Dn="/",Bn={type:"literal",value:"/",description:'"/"'},Gn="%",zn={type:"literal",value:"%",description:'"%"'},Un=function(e){return new Uo({type:"operator",operator:e})},Qn=function(e,t){return function(e,t){for(var r=e,n=0;n<t.length;n++)r=new Uo({type:"binary",operator:t[n][1],left:r,right:t[n][3]});return r}(e,t)},Zn=function(){return new Uo({type:"operator",operator:"+"})},Wn=function(){return new Uo({type:"operator",operator:"-"})},Hn="<<",$n={type:"literal",value:"<<",description:'"<<"'},Xn=">>",Jn={type:"literal",value:">>",description:'">>"'},Kn="<",Yn={type:"literal",value:"<",description:'"<"'},ei=function(e){return new Uo({type:"operator",operator:"<"+(e||"")})},ti=">",ri={type:"literal",value:">",description:'">"'},ni=function(e){return new Uo({type:"operator",operator:">"+(e||"")})},ii="==",si={type:"literal",value:"==",description:'"=="'},oi="!=",ai={type:"literal",value:"!=",description:'"!="'},ci=function(e){return new Uo({type:"operator",operator:e})},ui="&",li={type:"literal",value:"&",description:'"&"'},hi=function(){return new Uo({type:"operator",operator:"&"})},di="^",pi={type:"literal",value:"^",description:'"^"'},fi=function(){return new Uo({type:"operator",operator:"^"})},vi="|",mi={type:"literal",value:"|",description:'"|"'},yi=function(){return new Uo({type:"operator",operator:"|"})},_i="&&",bi={type:"literal",value:"&&",description:'"&&"'},gi=function(){return new Uo({type:"operator",operator:"&&"})},Si="^^",Ai={type:"literal",value:"^^",description:'"^^"'},Ti=function(){return new Uo({type:"operator",operator:"^^"})},xi="||",ki={type:"literal",value:"||",description:'"||"'},Ci=function(){return new Uo({type:"operator",operator:"||"})},wi="?",Li={type:"literal",value:"?",description:'"?"'},Ni=":",Vi={type:"literal",value:":",description:'":"'},Ei=function(e,t){return result=e,t&&(result=new Uo({type:"ternary",condition:e,is_true:t[3],is_false:t[7]})),result},Pi="*=",Fi={type:"literal",value:"*=",description:'"*="'},Ri="/=",ji={type:"literal",value:"/=",description:'"/="'},Mi="%=",Ii={type:"literal",value:"%=",description:'"%="'},Oi="+=",qi={type:"literal",value:"+=",description:'"+="'},Di="-=",Bi={type:"literal",value:"-=",description:'"-="'},Gi="<<=",zi={type:"literal",value:"<<=",description:'"<<="'},Ui=">>=",Qi={type:"literal",value:">>=",description:'">>="'},Zi="&=",Wi={type:"literal",value:"&=",description:'"&="'},Hi="^=",$i={type:"literal",value:"^=",description:'"^="'},Xi="|=",Ji={type:"literal",value:"|=",description:'"|="'},Ki=function(e,t,r){return new Uo({type:"binary",operator:new Uo({type:"operator",operator:t}),left:e,right:r})},Yi=0,es=0,ts=0,rs={line:1,column:1,seenCR:!1},ns=0,is=[],ss=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');n=r[t.startRule]}function os(e){return ts!==e&&(e<ts&&(ts=0,rs={line:1,column:1,seenCR:!1}),function(e,t,r){var n,i;for(n=t;n<r;n++)"\n"===(i=d.charAt(n))?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(rs,ts,e),ts=e),rs}function as(e){Yi<ns||(ns<Yi&&(ns=Yi,is=[]),is.push(e))}function cs(e,t,r){var n=os(r),i=r<d.length?d.charAt(r):null;return null!==t&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(t),new Zo(null!==e?e:function(e,t){var r,n=new Array(e.length);for(r=0;r<e.length;r++)n[r]=e[r].description;function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}return"Expected "+(1<e.length?n.slice(0,-1).join(", ")+" or "+n[e.length-1]:n[0])+" but "+(t?'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+i(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+i(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+i(e)})+'"':"end of input")+" found."}(t,i),t,i,r,n.line,n.column)}function us(){return xs()}function ls(){var e,t;return e=Yi,i.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(s)),t!==p&&(es=e,t=o()),e=t}function hs(){var e,t;return e=Yi,ss++,d.length>Yi?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(a)),ss--,e=t===p?u:(Yi=e,f)}function ds(){var e,t;if(ss++,e=[],(t=ls())===p&&(l.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(h)),t===p&&(v.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(m)),t===p&&(t=vs()))),t!==p)for(;t!==p;)e.push(t),(t=ls())===p&&(l.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(h)),t===p&&(v.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(m)),t===p&&(t=vs())));else e=f;return ss--,e===p&&(t=p,0===ss&&as(c)),e}function ps(){var e,t,r,n,i,s;if(e=Yi,d.substr(Yi,2)===y?(t=y,Yi+=2):(t=p,0===ss&&as(_)),t!==p){for(r=[],i=n=Yi,ss++,d.substr(Yi,2)===b?(s=b,Yi+=2):(s=p,0===ss&&as(g)),ss--,n=(i=s===p?u:(Yi=i,f))!==p?(d.length>Yi?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(a)),s!==p?i=[i,s]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),i=n=Yi,ss++,d.substr(Yi,2)===b?(s=b,Yi+=2):(s=p,0===ss&&as(g)),ss--,n=(i=s===p?u:(Yi=i,f))!==p?(d.length>Yi?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(a)),s!==p?i=[i,s]:(Yi=n,f)):(Yi=n,f);e=r!==p?(d.substr(Yi,2)===b?(n=b,Yi+=2):(n=p,0===ss&&as(g)),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;if(e===p)if(e=Yi,d.substr(Yi,2)===S?(t=S,Yi+=2):(t=p,0===ss&&as(A)),t!==p){for(r=[],T.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(x));n!==p;)r.push(n),T.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(x));e=r!==p?t=[t,r]:(Yi=e,f)}else Yi=e,e=f;return e}function fs(){var e,t;if(e=[],v.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(m)),t===p&&(t=ps()),t!==p)for(;t!==p;)e.push(t),v.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(m)),t===p&&(t=ps());else e=f;return e}function vs(){var e,t,r,n,i,s;if(ss++,e=Yi,d.substr(Yi,2)===y?(t=y,Yi+=2):(t=p,0===ss&&as(_)),t!==p){for(r=[],i=n=Yi,ss++,d.substr(Yi,2)===b?(s=b,Yi+=2):(s=p,0===ss&&as(g)),ss--,n=(i=s===p?u:(Yi=i,f))!==p?(d.length>Yi?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(a)),s!==p?i=[i,s]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),i=n=Yi,ss++,d.substr(Yi,2)===b?(s=b,Yi+=2):(s=p,0===ss&&as(g)),ss--,n=(i=s===p?u:(Yi=i,f))!==p?(d.length>Yi?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(a)),s!==p?i=[i,s]:(Yi=n,f)):(Yi=n,f);e=r!==p?(d.substr(Yi,2)===b?(n=b,Yi+=2):(n=p,0===ss&&as(g)),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;if(e===p)if(e=Yi,d.substr(Yi,2)===S?(t=S,Yi+=2):(t=p,0===ss&&as(A)),t!==p){for(r=[],T.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(x));n!==p;)r.push(n),T.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(x));e=r!==p?((n=ls())===p&&(n=hs()),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;return ss--,e===p&&(t=p,0===ss&&as(k)),e}function ms(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(59===d.charCodeAt(Yi)?(r=w,Yi++):(r=p,0===ss&&as(L)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function ys(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(44===d.charCodeAt(Yi)?(r=N,Yi++):(r=p,0===ss&&as(V)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function _s(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(91===d.charCodeAt(Yi)?(r=E,Yi++):(r=p,0===ss&&as(P)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function bs(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(93===d.charCodeAt(Yi)?(r=F,Yi++):(r=p,0===ss&&as(R)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function gs(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(40===d.charCodeAt(Yi)?(r=I,Yi++):(r=p,0===ss&&as(O)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function Ss(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(41===d.charCodeAt(Yi)?(r=q,Yi++):(r=p,0===ss&&as(D)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function As(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(123===d.charCodeAt(Yi)?(r=B,Yi++):(r=p,0===ss&&as(G)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function Ts(){var e,t,r,n;return e=Yi,(t=ds())===p&&(t=C),e=t!==p?(125===d.charCodeAt(Yi)?(r=z,Yi++):(r=p,0===ss&&as(U)),r!==p?((n=ds())===p&&(n=C),n!==p?t=[t,r,n]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function xs(){var e,t,r;for(e=Yi,t=[],r=ks();r!==p;)t.push(r),r=ks();return t!==p&&(es=e,t=Q(t)),e=t}function ks(){var e,t;return e=Yi,(t=function(){var e,t,r,n,i,s;if(t=e=Yi,(t=(r=Vs())!==p?(n=xs())!==p?r=[r,n]:(Yi=t,f):(Yi=t,f))!==p){for(r=[],n=Yi,i=Es(),n=i!==p&&(s=xs())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,i=Es(),n=i!==p&&(s=xs())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(n=Yi,i=Ps(),(n=i!==p&&(s=xs())!==p?i=[i,s]:(Yi=n,f))===p&&(n=C),n!==p&&(i=Fs())!==p?(es=e,t=Ie(t,r,n)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;return e}())===p&&(t=function(){var e;return(e=function(){var e,t,r;return e=Yi,e=(t=zs())!==p?(r=js())!==p?(es=e,t=Oe(t,r)):(Yi=e,f):(Yi=e,f)}())===p&&(e=function(){var e,t,r;return(e=Gs())===p&&(e=Yi,t=function(){var e,t,r,n;return ss++,t=e=Yi,(t=(r=ro())!==p?(n=ds())!==p?r=[r,n]:(Yi=t,f):(Yi=t,f))===p&&(t=C),e=t!==p?(r=Js())!==p?(es=e,t=Qt(t,r)):(Yi=e,f):(Yi=e,f),ss--,e===p&&(t=p,0===ss&&as(Xt)),e}(),(e=t!==p&&ds()!==p&&(r=Qs())!==p&&ms()!==p?(es=e,t=At(t,r)):(Yi=e,f))===p&&(e=Yi,t=function(){var e,t,r;return ss++,e=Yi,e=(t=Ys())!==p?ds()!==p&&(r=Js())!==p?(es=e,t=$t(t,r)):(Yi=e,f):(Yi=e,f),ss--,e===p&&(t=p,0===ss&&as(Ut)),e}(),e=t!==p&&ds()!==p&&(r=function(){var e,t,r,n,i,s;if(e=Yi,(t=Ws())!==p){for(r=[],n=Yi,i=ys(),n=i!==p&&(s=Ws())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,i=ys(),n=i!==p&&(s=Ws())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(es=e,t=Rt(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}())!==p&&ms()!==p?(es=e,t=At(t,r)):(Yi=e,f))),e}())===p&&(e=Ns())===p&&(e=Cs())===p&&(e=function(){var e,t,r,n,i,s,o;return t=e=Yi,(r=ro())===p&&(r=Ys()),(t=r!==p?(n=ds())!==p?r=[r,n]:(Yi=t,f):(Yi=t,f))===p&&(t=C),e=t!==p?(d.substr(Yi,6)===Dt?(r=Dt,Yi+=6):(r=p,0===ss&&as(Bt)),r!==p?(n=Yi,i=ds(),(n=i!==p&&(s=io())!==p?i=[i,s]:(Yi=n,f))===p&&(n=C),n!==p&&(i=As())!==p&&(s=function(){var e,t,r,n,i,s,o;if(t=[],r=e=Yi,(r=(n=Ks())!==p?(i=ds())!==p&&(s=Zs())!==p&&(o=ms())!==p?n=[n,i,s,o]:(Yi=r,f):(Yi=r,f))!==p)for(;r!==p;)t.push(r),r=Yi,n=Ks(),r=n!==p&&(i=ds())!==p&&(s=Zs())!==p&&(o=ms())!==p?n=[n,i,s,o]:(Yi=r,f);else t=f;return t!==p&&(es=e,t=qt(t)),e=t}())!==p&&Ts()!==p?((o=function(){var e,t,r,n,i,s;if(e=Yi,(t=$s())!==p){for(r=[],n=Yi,i=ys(),n=i!==p&&(s=$s())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,i=ys(),n=i!==p&&(s=$s())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(es=e,t=Rt(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}())===p&&(o=C),o!==p&&ms()!==p?(es=e,t=Gt(t,n,s,o)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}())===p&&(e=Ls()),e}()),t!==p&&(es=e,t=Z(t)),(e=t)===p&&(e=Yi,(t=ds())!==p&&(es=e,t=W()),e=t),e}function Cs(){var e,t,r,n,i,s;if(e=Yi,35===d.charCodeAt(Yi)?(t=H,Yi++):(t=p,0===ss&&as($)),t!==p)if(d.substr(Yi,5)===X?(r=X,Yi+=5):(r=p,0===ss&&as(J)),r===p&&(d.substr(Yi,6)===K?(r=K,Yi+=6):(r=p,0===ss&&as(Y)),r===p&&(d.substr(Yi,7)===ee?(r=ee,Yi+=7):(r=p,0===ss&&as(te)),r===p&&(d.substr(Yi,5)===re?(r=re,Yi+=5):(r=p,0===ss&&as(ne)),r===p&&(d.substr(Yi,9)===ie?(r=ie,Yi+=9):(r=p,0===ss&&as(se)),r===p&&(d.substr(Yi,4)===oe?(r=oe,Yi+=4):(r=p,0===ss&&as(ae))))))),r!==p)if(ds()!==p){for(n=Yi,i=[],T.test(d.charAt(Yi))?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(x));s!==p;)i.push(s),T.test(d.charAt(Yi))?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(x));i!==p&&(es=n,i=ce(i)),e=(n=i)!==p?((i=ls())===p&&(i=hs()),i!==p?(es=e,t=ue(r,n)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;return e}function ws(){var e,t,r,n;if(e=Yi,le.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(he)),t!==p){for(r=[],de.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(pe));n!==p;)r.push(n),de.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(pe));e=r!==p?(es=e,t=fe(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function Ls(){var e,t,r,n,i;return e=Yi,e=(t=ws())!==p?((r=ds())===p&&(r=C),r!==p&&gs()!==p?((n=po())===p&&(n=C),n!==p?(41===d.charCodeAt(Yi)?(i=q,Yi++):(i=p,0===ss&&as(D)),i!==p?(es=e,t=me(t,n)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function Ns(){var e,t,r,n,i,s,o,a,c,u;if(e=Yi,35===d.charCodeAt(Yi)?(t=H,Yi++):(t=p,0===ss&&as($)),t!==p)if((r=ds())===p&&(r=C),r!==p)if(d.substr(Yi,6)===ye?(n=ye,Yi+=6):(n=p,0===ss&&as(_e)),n!==p)if(ds()!==p)if((i=ws())!==p)if((s=function(){var e,t,r,n,i,s,o;if(e=Yi,40===d.charCodeAt(Yi)?(t=I,Yi++):(t=p,0===ss&&as(O)),t!==p)if((r=ws())===p&&(r=C),r!==p){for(n=[],i=Yi,i=(s=ys())!==p&&(o=ws())!==p?s=[s,o]:(Yi=i,f);i!==p;)n.push(i),i=Yi,i=(s=ys())!==p&&(o=ws())!==p?s=[s,o]:(Yi=i,f);e=n!==p&&(i=Ss())!==p?(es=e,t=ve(r,n)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;return e}())===p&&(s=C),s!==p){for(o=[],be.test(d.charAt(Yi))?(a=d.charAt(Yi),Yi++):(a=p,0===ss&&as(ge));a!==p;)o.push(a),be.test(d.charAt(Yi))?(a=d.charAt(Yi),Yi++):(a=p,0===ss&&as(ge));if(o!==p){for(a=Yi,c=[],T.test(d.charAt(Yi))?(u=d.charAt(Yi),Yi++):(u=p,0===ss&&as(x));u!==p;)c.push(u),T.test(d.charAt(Yi))?(u=d.charAt(Yi),Yi++):(u=p,0===ss&&as(x));c!==p&&(es=a,c=ce(c)),e=(a=c)!==p?((c=ls())===p&&(c=hs()),c!==p?(es=e,t=Se(i,s,a)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f}else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;return e}function Vs(){var e,t,r,n,i,s,o;if(e=Yi,35===d.charCodeAt(Yi)?(t=H,Yi++):(t=p,0===ss&&as($)),t!==p)if((r=ds())===p&&(r=C),r!==p)if(d.substr(Yi,5)===Ae?(n=Ae,Yi+=5):(n=p,0===ss&&as(Te)),n===p&&(d.substr(Yi,6)===xe?(n=xe,Yi+=6):(n=p,0===ss&&as(ke)),n===p&&(d.substr(Yi,2)===Ce?(n=Ce,Yi+=2):(n=p,0===ss&&as(we)))),n!==p)if(ds()!==p){for(i=Yi,s=[],T.test(d.charAt(Yi))?(o=d.charAt(Yi),Yi++):(o=p,0===ss&&as(x));o!==p;)s.push(o),T.test(d.charAt(Yi))?(o=d.charAt(Yi),Yi++):(o=p,0===ss&&as(x));s!==p&&(es=i,s=ce(s)),e=(i=s)!==p?((s=ls())===p&&(s=hs()),s!==p?(es=e,t=Le(n,i)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;return e}function Es(){var e,t,r,n,i,s,o;if(e=Yi,35===d.charCodeAt(Yi)?(t=H,Yi++):(t=p,0===ss&&as($)),t!==p)if((r=ds())===p&&(r=C),r!==p)if(d.substr(Yi,4)===Ne?(n=Ne,Yi+=4):(n=p,0===ss&&as(Ve)),n!==p)if(ds()!==p){for(i=Yi,s=[],T.test(d.charAt(Yi))?(o=d.charAt(Yi),Yi++):(o=p,0===ss&&as(x));o!==p;)s.push(o),T.test(d.charAt(Yi))?(o=d.charAt(Yi),Yi++):(o=p,0===ss&&as(x));s!==p&&(es=i,s=ce(s)),e=(i=s)!==p?((s=ls())===p&&(s=hs()),s!==p?(es=e,t=Ee(i)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;return e}function Ps(){var e,t,r,n,i;return e=Yi,35===d.charCodeAt(Yi)?(t=H,Yi++):(t=p,0===ss&&as($)),e=t!==p?((r=ds())===p&&(r=C),r!==p?(d.substr(Yi,4)===Pe?(n=Pe,Yi+=4):(n=p,0===ss&&as(Fe)),n!==p?((i=fs())===p&&(i=C),i!==p&&ls()!==p?(es=e,t=Re()):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function Fs(){var e,t,r,n,i,s,o;return e=Yi,35===d.charCodeAt(Yi)?(t=H,Yi++):(t=p,0===ss&&as($)),e=t!==p?((r=ds())===p&&(r=C),r!==p?(d.substr(Yi,5)===je?(n=je,Yi+=5):(n=p,0===ss&&as(Me)),n!==p?((i=fs())===p&&(i=C),i!==p?((s=ls())===p&&(s=hs()),s!==p?((o=ds())===p&&(o=C),o!==p?t=[t,r,n,i,s,o]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function Rs(){var e,t,r,n,i,s;if(t=e=Yi,(t=(r=Vs())!==p&&(n=Ms())!==p?r=[r,n]:(Yi=t,f))!==p){for(r=[],n=Yi,n=(i=Es())!==p&&(s=Ms())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,n=(i=Es())!==p&&(s=Ms())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(n=Yi,(n=(i=Ps())!==p&&(s=Ms())!==p?i=[i,s]:(Yi=n,f))===p&&(n=C),n!==p&&(i=Fs())!==p?(es=e,t=Ie(t,r,n)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;return e}function js(){var e,t;return e=Yi,e=As()!==p?((t=Ms())===p&&(t=C),t!==p&&Ts()!==p?(es=e,qe(t)):(Yi=e,f)):(Yi=e,f)}function Ms(){var e,t,r,n;if(e=Yi,(t=ds())===p&&(t=C),t!==p){for(r=[],n=Is();n!==p;)r.push(n),n=Is();e=r!==p?((n=ds())===p&&(n=C),n!==p?(es=e,t=De(r)):(Yi=e,f)):(Yi=e,f)}else Yi=e,e=f;return e}function Is(){var e;return(e=js())===p&&(e=qs())===p&&(e=Rs()),e}function Os(){var e;return(e=js())===p&&(e=qs())===p&&(e=Rs()),e}function qs(){var e,t;return e=Yi,(t=Gs())===p&&(t=Bs())===p&&(t=function(){var e,t,r,n,i,s,o,a;return e=Yi,d.substr(Yi,2)===Ce?(t=Ce,Yi+=2):(t=p,0===ss&&as(we)),e=t!==p?gs()!==p&&(r=Io())!==p&&Ss()!==p&&(n=Os())!==p?(i=Yi,d.substr(Yi,4)===Pe?(s=Pe,Yi+=4):(s=p,0===ss&&as(Fe)),(i=s!==p?((o=ds())===p&&(o=C),o!==p&&(a=Os())!==p?s=[s,o,a]:(Yi=i,f)):(Yi=i,f))===p&&(i=C),i!==p?(es=e,t=Ge(r,n,i)):(Yi=e,f)):(Yi=e,f):(Yi=e,f)}())===p&&(t=function(){var e;return(e=function(){var e,t,r;return e=Yi,e=(t=Ds())!==p?(r=Is())!==p?(es=e,t=$e(t,r)):(Yi=e,f):(Yi=e,f)}())===p&&(e=function(){var e,t,r,n;return e=Yi,d.substr(Yi,2)===Xe?(t=Xe,Yi+=2):(t=p,0===ss&&as(Je)),e=t!==p?(r=Os())!==p&&(n=Ds())!==p?(es=e,t=Ke(r,n)):(Yi=e,f):(Yi=e,f)}())===p&&(e=function(){var e,t,r,n,i,s;return e=Yi,d.substr(Yi,3)===ze?(t=ze,Yi+=3):(t=p,0===ss&&as(Ue)),e=t!==p?gs()!==p?((r=Bs())===p&&(r=Gs()),r!==p?((n=Oo())===p&&(n=C),n!==p&&ms()!==p?((i=Io())===p&&(i=C),i!==p&&Ss()!==p&&(s=Is())!==p?(es=e,t=Qe(r,n,i,s)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f):(Yi=e,f)}()),e}())===p&&(t=function(){var e,t,r,n,i;return e=Yi,d.substr(Yi,6)===Ye?(t=Ye,Yi+=6):(t=p,0===ss&&as(et)),(e=t!==p?(r=Io())!==p&&(n=ms())!==p?(es=e,t=tt(r)):(Yi=e,f):(Yi=e,f))===p&&(t=e=Yi,d.substr(Yi,8)===rt?(r=rt,Yi+=8):(r=p,0===ss&&as(nt)),(t=r!==p&&(n=ms())!==p?r=[r,n]:(Yi=t,f))===p&&(t=Yi,d.substr(Yi,5)===it?(r=it,Yi+=5):(r=p,0===ss&&as(st)),(t=r!==p&&(n=ms())!==p?r=[r,n]:(Yi=t,f))===p&&(t=Yi,d.substr(Yi,6)===Ye?(r=Ye,Yi+=6):(r=p,0===ss&&as(et)),(t=r!==p&&(n=ms())!==p?r=[r,n]:(Yi=t,f))===p&&(es=r=t=Yi,n=ot(),r=(n=n?u:f)!==p?(d.substr(Yi,7)===at?(i=at,Yi+=7):(i=p,0===ss&&as(ct)),i!==p?(es=r,n=ut()):(Yi=r,f)):(Yi=r,f),t=r!==p&&(n=ms())!==p?r=[r,n]:(Yi=t,f)))),t!==p&&(es=e,t=lt(t)),e=t),e}())===p&&(t=Ns())===p&&(t=Cs())===p&&(t=Ls()),t!==p&&(es=e,t=Be(t)),e=t}function Ds(){var e,t,r;return e=Yi,d.substr(Yi,5)===Ze?(t=Ze,Yi+=5):(t=p,0===ss&&as(We)),e=t!==p&&gs()!==p&&(r=Oo())!==p&&Ss()!==p?(es=e,t=He(r)):(Yi=e,f)}function Bs(){var e,t;return e=Yi,(t=Io())===p&&(t=C),e=t!==p&&ms()!==p?(es=e,t=ht(t)):(Yi=e,f)}function Gs(){var e,t,r,n,i,s,o,a,c;if(ss++,e=Yi,(e=(t=zs())!==p&&(r=ms())!==p?(es=e,t=pt(t)):(Yi=e,f))===p&&(e=Yi,(e=(t=Ks())!==p&&(r=ds())!==p&&(n=Qs())!==p&&(i=ms())!==p?(es=e,t=ft(t,n)):(Yi=e,f))===p)){if(es=e=Yi,(t=(t=vt())?u:f)!==p)if(d.substr(Yi,9)===mt?(r=mt,Yi+=9):(r=p,0===ss&&as(yt)),r!==p)if((n=ds())!==p)if((i=io())!==p){for(s=[],o=Yi,o=(a=ys())!==p&&(c=io())!==p?a=[a,c]:(Yi=o,f);o!==p;)s.push(o),o=Yi,o=(a=ys())!==p&&(c=io())!==p?a=[a,c]:(Yi=o,f);e=s!==p&&(o=ms())!==p?(es=e,t=_t(i,s)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;e===p&&(e=Yi,d.substr(Yi,9)===bt?(t=bt,Yi+=9):(t=p,0===ss&&as(gt)),e=t!==p&&(r=ds())!==p&&(n=eo())!==p&&(i=ds())!==p&&(s=no())!==p&&(o=ms())!==p?(es=e,t=St(n,s)):(Yi=e,f))}return ss--,e===p&&(t=p,0===ss&&as(dt)),e}function zs(){var e,t,r,n;return e=Yi,(t=function(){var e,t;return ss++,e=Yi,d.substr(Yi,4)===Tt?(t=Tt,Yi+=4):(t=p,0===ss&&as(xt)),t!==p&&(es=e,t=pr()),ss--,(e=t)===p&&(t=p,0===ss&&as(dr)),e}())===p&&(t=Js()),e=t!==p&&ds()!==p&&(r=io())!==p&&gs()!==p?((n=function(){var e,t,r,n,i,s;if(d.substr(Yi,4)===Tt?(e=Tt,Yi+=4):(e=p,0===ss&&as(xt)),e===p)if(e=Yi,(t=Us())!==p){for(r=[],n=Yi,n=(i=ys())!==p&&(s=Us())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,n=(i=ys())!==p&&(s=Us())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(es=e,t=kt(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}())===p&&(n=C),n!==p&&Ss()!==p?(es=e,t=Ct(t,r,n)):(Yi=e,f)):(Yi=e,f)}function Us(){var e,t,r,n,i,s,o,a,c,u,l,h;return t=e=Yi,(t=(r=to())!==p&&(n=ds())!==p?r=[r,n]:(Yi=t,f))===p&&(t=C),e=t!==p?(r=Yi,d.substr(Yi,5)===wt?(h=wt,Yi+=5):(h=p,0===ss&&as(Lt)),h===p&&(d.substr(Yi,2)===Nt?(h=Nt,Yi+=2):(h=p,0===ss&&as(Vt)),h===p&&(d.substr(Yi,3)===Et?(h=Et,Yi+=3):(h=p,0===ss&&as(Pt)))),(r=(n=h)!==p&&(i=ds())!==p?n=[n,i]:(Yi=r,f))===p&&(r=C),r!==p?(n=Yi,(n=(i=eo())!==p&&(s=ds())!==p?i=[i,s]:(Yi=n,f))===p&&(n=C),n!==p&&(i=no())!==p&&(s=ds())!==p&&(o=io())!==p?(a=Yi,(a=(c=_s())!==p&&(u=Mo())!==p&&(l=bs())!==p?c=[c,u,l]:(Yi=a,f))===p&&(a=C),a!==p?(es=e,t=Ft(t,r,n,i,o,a)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)}function Qs(){var e,t,r,n,i,s;if(e=Yi,(t=Xs())!==p){for(r=[],n=Yi,n=(i=ys())!==p&&(s=Xs())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,n=(i=ys())!==p&&(s=Xs())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(es=e,t=Rt(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function Zs(){var e,t,r,n,i,s;if(e=Yi,(t=Hs())!==p){for(r=[],n=Yi,n=(i=ys())!==p&&(s=Hs())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,n=(i=ys())!==p&&(s=Hs())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(es=e,t=Rt(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function Ws(){var e,t;return e=Yi,(t=io())!==p&&(es=e,t=jt(t)),e=t}function Hs(){var e,t,r;return e=Yi,(e=(t=io())!==p&&_s()!==p&&(r=Mo())!==p&&bs()!==p?(es=e,t=Mt(t,r)):(Yi=e,f))===p&&(e=Ws()),e}function $s(){var e,t;return e=Yi,(e=(t=io())!==p&&_s()!==p&&bs()!==p?(es=e,t=It(t)):(Yi=e,f))===p&&(e=Hs()),e}function Xs(){var e,t,r,n,i,s,o;return e=Yi,(e=(t=io())!==p?(n=Yi,(i=ds())===p&&(i=C),(n=i!==p?(61===d.charCodeAt(Yi)?(s=j,Yi++):(s=p,0===ss&&as(M)),s!==p?((o=ds())===p&&(o=C),o!==p?i=[i,s,o]:(Yi=n,f)):(Yi=n,f)):(Yi=n,f))!==p&&(r=Mo())!==p?(es=e,t=Ot(t,r)):(Yi=e,f)):(Yi=e,f))===p&&(e=$s()),e}function Js(){var e,t,r,n;return t=e=Yi,(t=(r=eo())!==p&&(n=ds())!==p?r=[r,n]:(Yi=t,f))===p&&(t=C),e=t!==p&&(r=no())!==p?(es=e,t=zt(t,r)):(Yi=e,f)}function Ks(){var e,t,r,n;return ss++,t=e=Yi,(t=(r=to())!==p&&(n=ds())!==p?r=[r,n]:(Yi=t,f))===p&&(t=C),e=t!==p&&(r=Js())!==p?(es=e,t=Qt(t,r)):(Yi=e,f),ss--,e===p&&(t=p,0===ss&&as(Ut)),e}function Ys(){var e,t;return es=e=Yi,e=(vt()?u:f)!==p?(d.substr(Yi,9)===Zt?(t=Zt,Yi+=9):(t=p,0===ss&&as(Wt)),t!==p?(es=e,Ht()):(Yi=e,f)):(Yi=e,f)}function eo(){var e;return ss++,d.substr(Yi,5)===Kt?(e=Kt,Yi+=5):(e=p,0===ss&&as(Yt)),e===p&&(d.substr(Yi,7)===er?(e=er,Yi+=7):(e=p,0===ss&&as(tr)),e===p&&(d.substr(Yi,4)===rr?(e=rr,Yi+=4):(e=p,0===ss&&as(nr)))),ss--,e===p&&0===ss&&as(Jt),e}function to(){var e;return d.substr(Yi,5)===ir?(e=ir,Yi+=5):(e=p,0===ss&&as(sr)),e}function ro(){var e,t,r;return ss++,(e=to())===p&&(d.substr(Yi,7)===ar?(e=ar,Yi+=7):(e=p,0===ss&&as(cr)),e===p&&(e=Yi,d.substr(Yi,9)===mt?(t=mt,Yi+=9):(t=p,0===ss&&as(yt)),(e=t!==p&&ds()!==p?(d.substr(Yi,7)===ar?(r=ar,Yi+=7):(r=p,0===ss&&as(cr)),r!==p?(es=e,t=ur()):(Yi=e,f)):(Yi=e,f))===p&&(d.substr(Yi,7)===lr?(e=lr,Yi+=7):(e=p,0===ss&&as(hr))))),ss--,e===p&&(t=p,0===ss&&as(or)),e}function no(){var e,t;return ss++,d.substr(Yi,5)===vr?(e=vr,Yi+=5):(e=p,0===ss&&as(mr)),e===p&&(d.substr(Yi,3)===yr?(e=yr,Yi+=3):(e=p,0===ss&&as(_r)),e===p&&(d.substr(Yi,4)===br?(e=br,Yi+=4):(e=p,0===ss&&as(gr)),e===p&&(d.substr(Yi,9)===Sr?(e=Sr,Yi+=9):(e=p,0===ss&&as(Ar)),e===p&&(d.substr(Yi,11)===Tr?(e=Tr,Yi+=11):(e=p,0===ss&&as(xr)),e===p&&(e=so())===p&&(e=oo())===p&&(e=Yi,(t=io())!==p&&(es=e,t=kr(t)),e=t))))),ss--,e===p&&(t=p,0===ss&&as(fr)),e}function io(){var e,t,r,n,i;if(ss++,ss++,r=t=e=Yi,r=(n=function(){var e;return ss++,d.substr(Yi,9)===Zt?(e=Zt,Yi+=9):(e=p,0===ss&&as(Wt)),e===p&&(d.substr(Yi,5)===ir?(e=ir,Yi+=5):(e=p,0===ss&&as(sr)),e===p&&(d.substr(Yi,4)===br?(e=br,Yi+=4):(e=p,0===ss&&as(gr)),e===p&&(d.substr(Yi,5)===vr?(e=vr,Yi+=5):(e=p,0===ss&&as(mr)),e===p&&(d.substr(Yi,3)===yr?(e=yr,Yi+=3):(e=p,0===ss&&as(_r)),e===p&&(d.substr(Yi,5)===it?(e=it,Yi+=5):(e=p,0===ss&&as(st)),e===p&&(d.substr(Yi,8)===rt?(e=rt,Yi+=8):(e=p,0===ss&&as(nt)),e===p&&(d.substr(Yi,2)===Xe?(e=Xe,Yi+=2):(e=p,0===ss&&as(Je)),e===p&&(d.substr(Yi,4)===Pe?(e=Pe,Yi+=4):(e=p,0===ss&&as(Fe)),e===p&&(d.substr(Yi,3)===ze?(e=ze,Yi+=3):(e=p,0===ss&&as(Ue)),e===p&&(d.substr(Yi,2)===Ce?(e=Ce,Yi+=2):(e=p,0===ss&&as(we)),e===p&&(d.substr(Yi,7)===at?(e=at,Yi+=7):(e=p,0===ss&&as(ct)),e===p&&(d.substr(Yi,6)===Ye?(e=Ye,Yi+=6):(e=p,0===ss&&as(et)),e===p&&(e=so())===p&&(e=oo())===p&&(d.substr(Yi,2)===Nt?(e=Nt,Yi+=2):(e=p,0===ss&&as(Vt)),e===p&&(d.substr(Yi,3)===Et?(e=Et,Yi+=3):(e=p,0===ss&&as(Pt)),e===p&&(d.substr(Yi,5)===wt?(e=wt,Yi+=5):(e=p,0===ss&&as(Lt)),e===p&&(d.substr(Yi,7)===lr?(e=lr,Yi+=7):(e=p,0===ss&&as(hr)),e===p&&(d.substr(Yi,7)===ar?(e=ar,Yi+=7):(e=p,0===ss&&as(cr)),e===p&&(d.substr(Yi,9)===Sr?(e=Sr,Yi+=9):(e=p,0===ss&&as(Ar)),e===p&&(d.substr(Yi,11)===Tr?(e=Tr,Yi+=11):(e=p,0===ss&&as(xr)),e===p&&(d.substr(Yi,6)===Dt?(e=Dt,Yi+=6):(e=p,0===ss&&as(Bt)),e===p&&(d.substr(Yi,4)===Tt?(e=Tt,Yi+=4):(e=p,0===ss&&as(xt)),e===p&&(d.substr(Yi,5)===Ze?(e=Ze,Yi+=5):(e=p,0===ss&&as(We)),e===p&&(d.substr(Yi,5)===Kt?(e=Kt,Yi+=5):(e=p,0===ss&&as(Yt)),e===p&&(d.substr(Yi,7)===er?(e=er,Yi+=7):(e=p,0===ss&&as(tr)),e===p&&(d.substr(Yi,4)===rr?(e=rr,Yi+=4):(e=p,0===ss&&as(nr)),e===p&&(d.substr(Yi,4)===Vr?(e=Vr,Yi+=4):(e=p,0===ss&&as(Er)),e===p&&(d.substr(Yi,5)===Pr?(e=Pr,Yi+=5):(e=p,0===ss&&as(Fr))))))))))))))))))))))))))))),ss--,e===p&&0===ss&&as(Nr),e}())!==p?(wr.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(Lr)),i!==p?n=[n,i]:(Yi=r,f)):(Yi=r,f),ss--,(t=r===p?u:(Yi=t,f))!==p)if(le.test(d.charAt(Yi))?(r=d.charAt(Yi),Yi++):(r=p,0===ss&&as(he)),r!==p){for(n=[],de.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(pe));i!==p;)n.push(i),de.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(pe));e=n!==p?(es=e,t=fe(r,n)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;return ss--,e===p&&(t=p,0===ss&&as(Cr)),e}function so(){var e,t,r,n,i;return t=e=Yi,Rr.test(d.charAt(Yi))?(r=d.charAt(Yi),Yi++):(r=p,0===ss&&as(jr)),r===p&&(r=C),(t=r!==p?(d.substr(Yi,3)===Mr?(n=Mr,Yi+=3):(n=p,0===ss&&as(Ir)),n!==p?(Or.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(qr)),i!==p?r=[r,n,i]:(Yi=t,f)):(Yi=t,f)):(Yi=t,f))!==p&&(es=e,t=Dr(t)),e=t}function oo(){var e,t,r,n;return t=e=Yi,d.substr(Yi,3)===Br?(r=Br,Yi+=3):(r=p,0===ss&&as(Gr)),(t=r!==p?(Or.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(qr)),n!==p?r=[r,n]:(Yi=t,f)):(Yi=t,f))!==p&&(es=e,t=Dr(t)),e=t}function ao(){var e,t,r,n,i;if(e=Yi,ln.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(hn)),t!==p)if(dn.test(d.charAt(Yi))?(r=d.charAt(Yi),Yi++):(r=p,0===ss&&as(pn)),r===p&&(r=C),r!==p){if(n=[],Qr.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(Zr)),i!==p)for(;i!==p;)n.push(i),Qr.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(Zr));else n=f;e=n!==p?(es=e,t=fn(r,n)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;return e}function co(){var e,t,r,n,i;return(e=function(){var e,t,r;return e=Yi,e=(t=function(){var e,t;return e=Yi,(t=io())!==p&&(es=e,t=Ln(t)),(e=t)===p&&(e=no()),e}())!==p?gs()!==p?((r=po())===p&&(r=C),r!==p&&Ss()!==p?(es=e,t=wn(t,r)):(Yi=e,f)):(Yi=e,f):(Yi=e,f)}())===p&&(e=io())===p&&(e=function(){var e,t,r,n,i,s;for(t=e=Yi,r=[],Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr));n!==p;)r.push(n),Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr));if(r!==p)if(46===d.charCodeAt(Yi)?(n=on,Yi++):(n=p,0===ss&&as(an)),n!==p){if(i=[],Qr.test(d.charAt(Yi))?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(Zr)),s!==p)for(;s!==p;)i.push(s),Qr.test(d.charAt(Yi))?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(Zr));else i=f;t=i!==p?((s=ao())===p&&(s=C),s!==p?r=[r,n,i,s]:(Yi=t,f)):(Yi=t,f)}else Yi=t,t=f;else Yi=t,t=f;if(t===p){if(t=Yi,r=[],Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr)),n!==p)for(;n!==p;)r.push(n),Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr));else r=f;if(r!==p)if(46===d.charCodeAt(Yi)?(n=on,Yi++):(n=p,0===ss&&as(an)),n!==p){for(i=[],Qr.test(d.charAt(Yi))?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(Zr));s!==p;)i.push(s),Qr.test(d.charAt(Yi))?(s=d.charAt(Yi),Yi++):(s=p,0===ss&&as(Zr));t=i!==p?((s=ao())===p&&(s=C),s!==p?r=[r,n,i,s]:(Yi=t,f)):(Yi=t,f)}else Yi=t,t=f;else Yi=t,t=f}if(t!==p&&(es=e,t=cn(t)),(e=t)===p){if(t=e=Yi,r=[],Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr)),n!==p)for(;n!==p;)r.push(n),Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr));else r=f;(t=r!==p&&(n=ao())!==p?r=[r,n]:(Yi=t,f))!==p&&(es=e,t=un(t)),e=t}return e}())===p&&(e=function(){var e,t,r,n,i;if(e=Yi,zr.test(d.charAt(Yi))?(t=d.charAt(Yi),Yi++):(t=p,0===ss&&as(Ur)),t!==p){for(r=[],Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr));n!==p;)r.push(n),Qr.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(Zr));e=r!==p?(es=e,t=Wr(t,r)):(Yi=e,f)}else Yi=e,e=f;if(e===p){if(e=Yi,48===d.charCodeAt(Yi)?(t=Hr,Yi++):(t=p,0===ss&&as($r)),t!==p)if(Xr.test(d.charAt(Yi))?(r=d.charAt(Yi),Yi++):(r=p,0===ss&&as(Jr)),r!==p){if(n=[],Kr.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(Yr)),i!==p)for(;i!==p;)n.push(i),Kr.test(d.charAt(Yi))?(i=d.charAt(Yi),Yi++):(i=p,0===ss&&as(Yr));else n=f;e=n!==p?(es=e,t=en(n)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;if(e===p){if(e=Yi,48===d.charCodeAt(Yi)?(t=Hr,Yi++):(t=p,0===ss&&as($r)),t!==p){if(r=[],tn.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(rn)),n!==p)for(;n!==p;)r.push(n),tn.test(d.charAt(Yi))?(n=d.charAt(Yi),Yi++):(n=p,0===ss&&as(rn));else r=f;e=r!==p?(es=e,t=nn(r)):(Yi=e,f)}else Yi=e,e=f;e===p&&(e=Yi,48===d.charCodeAt(Yi)?(t=Hr,Yi++):(t=p,0===ss&&as($r)),t!==p&&(es=e,t=sn()),e=t)}}return e}())===p&&(n=Yi,d.substr(Yi,4)===Vr?(i=Vr,Yi+=4):(i=p,0===ss&&as(Er)),i===p&&(d.substr(Yi,5)===Pr?(i=Pr,Yi+=5):(i=p,0===ss&&as(Fr))),i!==p&&(es=n,i=mn(i)),(e=n=i)===p&&(t=Yi,e=t=gs()!==p&&(r=Io())!==p&&Ss()!==p?(es=t,vn(r)):(Yi=t,f))),e}function uo(){var e,t;return e=Yi,e=_s()!==p&&(t=Io())!==p&&bs()!==p?(es=e,yn(t)):(Yi=e,f)}function lo(){var e,t,r;return e=Yi,46===d.charCodeAt(Yi)?(t=on,Yi++):(t=p,0===ss&&as(an)),e=t!==p&&(r=io())!==p?(es=e,t=_n(r)):(Yi=e,f)}function ho(){var e,t,r,n,i,s;if(e=Yi,(t=function(){var e,t,r,n;if(e=Yi,(t=co())!==p){for(r=[],(n=lo())===p&&(n=uo());n!==p;)r.push(n),(n=lo())===p&&(n=uo());e=r!==p?(es=e,t=bn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}())!==p)if((r=ds())===p&&(r=C),r!==p)if(d.substr(Yi,2)===gn?(n=gn,Yi+=2):(n=p,0===ss&&as(Sn)),n===p&&(d.substr(Yi,2)===An?(n=An,Yi+=2):(n=p,0===ss&&as(Tn))),n===p&&(n=C),n!==p){for(i=[],(s=lo())===p&&(s=uo());s!==p;)i.push(s),(s=lo())===p&&(s=uo());e=i!==p?(es=e,t=xn(t,n,i)):(Yi=e,f)}else Yi=e,e=f;else Yi=e,e=f;else Yi=e,e=f;return e}function po(){var e,t,r,n,i,s;if(e=Yi,d.substr(Yi,4)===Tt?(t=Tt,Yi+=4):(t=p,0===ss&&as(xt)),t!==p&&(es=e,t=kn()),(e=t)===p)if(e=Yi,(t=Io())!==p){for(r=[],n=Yi,n=(i=ys())!==p&&(s=Io())!==p?i=[i,s]:(Yi=n,f);n!==p;)r.push(n),n=Yi,n=(i=ys())!==p&&(s=Io())!==p?i=[i,s]:(Yi=n,f);e=r!==p?(es=e,t=Cn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function fo(){var e,t,r,n;return e=Yi,d.substr(Yi,2)===gn?(t=gn,Yi+=2):(t=p,0===ss&&as(Sn)),t===p&&(d.substr(Yi,2)===An?(t=An,Yi+=2):(t=p,0===ss&&as(Tn)),t===p&&(33===d.charCodeAt(Yi)?(t=Nn,Yi++):(t=p,0===ss&&as(Vn)),t===p&&(126===d.charCodeAt(Yi)?(t=En,Yi++):(t=p,0===ss&&as(Pn)),t===p&&(43===d.charCodeAt(Yi)?(t=Fn,Yi++):(t=p,0===ss&&as(Rn)),t===p&&(45===d.charCodeAt(Yi)?(t=jn,Yi++):(t=p,0===ss&&as(Mn))))))),t===p&&(t=C),e=t!==p?((r=ds())===p&&(r=C),r!==p&&(n=ho())!==p?(es=e,t=In(t,n)):(Yi=e,f)):(Yi=e,f)}function vo(){var e,t,r,n;return e=Yi,42===d.charCodeAt(Yi)?(t=On,Yi++):(t=p,0===ss&&as(qn)),t===p&&(47===d.charCodeAt(Yi)?(t=Dn,Yi++):(t=p,0===ss&&as(Bn)),t===p&&(37===d.charCodeAt(Yi)?(t=Gn,Yi++):(t=p,0===ss&&as(zn)))),e=t!==p?(r=Yi,ss++,61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=Un(t)):(Yi=e,f)):(Yi=e,f)}function mo(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=fo())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=vo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=fo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=vo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=fo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function yo(){var e,t,r,n;return e=Yi,43===d.charCodeAt(Yi)?(t=Fn,Yi++):(t=p,0===ss&&as(Rn)),(e=t!==p?(r=Yi,ss++,43===d.charCodeAt(Yi)?(n=Fn,Yi++):(n=p,0===ss&&as(Rn)),n===p&&(61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M))),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=Zn()):(Yi=e,f)):(Yi=e,f))===p&&(e=Yi,45===d.charCodeAt(Yi)?(t=jn,Yi++):(t=p,0===ss&&as(Mn)),e=t!==p?(r=Yi,ss++,45===d.charCodeAt(Yi)?(n=jn,Yi++):(n=p,0===ss&&as(Mn)),n===p&&(61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M))),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=Wn()):(Yi=e,f)):(Yi=e,f)),e}function _o(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=mo())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=yo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=mo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=yo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=mo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function bo(){var e,t,r,n;return e=Yi,d.substr(Yi,2)===Hn?(t=Hn,Yi+=2):(t=p,0===ss&&as($n)),t===p&&(d.substr(Yi,2)===Xn?(t=Xn,Yi+=2):(t=p,0===ss&&as(Jn))),e=t!==p?(r=Yi,ss++,61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=Un(t)):(Yi=e,f)):(Yi=e,f)}function go(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=_o())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=bo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=_o())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=bo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=_o())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function So(){var e,t,r,n;return e=Yi,60===d.charCodeAt(Yi)?(t=Kn,Yi++):(t=p,0===ss&&as(Yn)),(e=t!==p?(r=Yi,ss++,60===d.charCodeAt(Yi)?(n=Kn,Yi++):(n=p,0===ss&&as(Yn)),ss--,(r=n===p?u:(Yi=r,f))!==p?(61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),n===p&&(n=C),n!==p?(es=e,t=ei(n)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f))===p&&(e=Yi,62===d.charCodeAt(Yi)?(t=ti,Yi++):(t=p,0===ss&&as(ri)),e=t!==p?(r=Yi,ss++,62===d.charCodeAt(Yi)?(n=ti,Yi++):(n=p,0===ss&&as(ri)),ss--,(r=n===p?u:(Yi=r,f))!==p?(61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),n===p&&(n=C),n!==p?(es=e,t=ni(n)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)),e}function Ao(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=go())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=So())!==p?((o=ds())===p&&(o=C),o!==p&&(a=go())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=So())!==p?((o=ds())===p&&(o=C),o!==p&&(a=go())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function To(){var e,t;return e=Yi,d.substr(Yi,2)===ii?(t=ii,Yi+=2):(t=p,0===ss&&as(si)),t===p&&(d.substr(Yi,2)===oi?(t=oi,Yi+=2):(t=p,0===ss&&as(ai))),t!==p&&(es=e,t=ci(t)),e=t}function xo(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=Ao())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=To())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Ao())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=To())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Ao())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function ko(){var e,t,r,n;return e=Yi,38===d.charCodeAt(Yi)?(t=ui,Yi++):(t=p,0===ss&&as(li)),e=t!==p?(r=Yi,ss++,61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),n===p&&(38===d.charCodeAt(Yi)?(n=ui,Yi++):(n=p,0===ss&&as(li))),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=hi()):(Yi=e,f)):(Yi=e,f)}function Co(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=xo())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=ko())!==p?((o=ds())===p&&(o=C),o!==p&&(a=xo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=ko())!==p?((o=ds())===p&&(o=C),o!==p&&(a=xo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function wo(){var e,t,r,n;return e=Yi,94===d.charCodeAt(Yi)?(t=di,Yi++):(t=p,0===ss&&as(pi)),e=t!==p?(r=Yi,ss++,61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),n===p&&(94===d.charCodeAt(Yi)?(n=di,Yi++):(n=p,0===ss&&as(pi))),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=fi()):(Yi=e,f)):(Yi=e,f)}function Lo(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=Co())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=wo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Co())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=wo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Co())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function No(){var e,t,r,n;return e=Yi,124===d.charCodeAt(Yi)?(t=vi,Yi++):(t=p,0===ss&&as(mi)),e=t!==p?(r=Yi,ss++,61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),n===p&&(124===d.charCodeAt(Yi)?(n=vi,Yi++):(n=p,0===ss&&as(mi))),ss--,(r=n===p?u:(Yi=r,f))!==p?(es=e,t=yi()):(Yi=e,f)):(Yi=e,f)}function Vo(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=Lo())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=No())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Lo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=No())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Lo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function Eo(){var e,t;return e=Yi,d.substr(Yi,2)===_i?(t=_i,Yi+=2):(t=p,0===ss&&as(bi)),t!==p&&(es=e,t=gi()),e=t}function Po(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=Vo())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=Eo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Vo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=Eo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Vo())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function Fo(){var e,t;return e=Yi,d.substr(Yi,2)===Si?(t=Si,Yi+=2):(t=p,0===ss&&as(Ai)),t!==p&&(es=e,t=Ti()),e=t}function Ro(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=Po())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=Fo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Po())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=Fo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Po())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}function jo(){var e,t;return e=Yi,d.substr(Yi,2)===xi?(t=xi,Yi+=2):(t=p,0===ss&&as(ki)),t!==p&&(es=e,t=Ci()),e=t}function Mo(){var e,t,r,n,i,s,o,a,c,u,l;return e=Yi,e=(t=function(){var e,t,r,n,i,s,o,a;if(e=Yi,(t=Ro())!==p){for(r=[],n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=jo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Ro())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);n!==p;)r.push(n),n=Yi,(i=ds())===p&&(i=C),n=i!==p&&(s=jo())!==p?((o=ds())===p&&(o=C),o!==p&&(a=Ro())!==p?i=[i,s,o,a]:(Yi=n,f)):(Yi=n,f);e=r!==p?(es=e,t=Qn(t,r)):(Yi=e,f)}else Yi=e,e=f;return e}())!==p?(r=Yi,(n=ds())===p&&(n=C),(r=n!==p?(63===d.charCodeAt(Yi)?(i=wi,Yi++):(i=p,0===ss&&as(Li)),i!==p?((s=ds())===p&&(s=C),s!==p&&(o=Io())!==p?((a=ds())===p&&(a=C),a!==p?(58===d.charCodeAt(Yi)?(c=Ni,Yi++):(c=p,0===ss&&as(Vi)),c!==p?((u=ds())===p&&(u=C),u!==p&&(l=Io())!==p?n=[n,i,s,o,a,c,u,l]:(Yi=r,f)):(Yi=r,f)):(Yi=r,f)):(Yi=r,f)):(Yi=r,f)):(Yi=r,f))===p&&(r=C),r!==p?(es=e,t=Ei(t,r)):(Yi=e,f)):(Yi=e,f)}function Io(){var e,t,r,n,i,s;return e=Yi,(e=(t=Mo())!==p?((r=ds())===p&&(r=C),r!==p?(61===d.charCodeAt(Yi)?(n=j,Yi++):(n=p,0===ss&&as(M)),n===p&&(d.substr(Yi,2)===Pi?(n=Pi,Yi+=2):(n=p,0===ss&&as(Fi)),n===p&&(d.substr(Yi,2)===Ri?(n=Ri,Yi+=2):(n=p,0===ss&&as(ji)),n===p&&(d.substr(Yi,2)===Mi?(n=Mi,Yi+=2):(n=p,0===ss&&as(Ii)),n===p&&(d.substr(Yi,2)===Oi?(n=Oi,Yi+=2):(n=p,0===ss&&as(qi)),n===p&&(d.substr(Yi,2)===Di?(n=Di,Yi+=2):(n=p,0===ss&&as(Bi)),n===p&&(d.substr(Yi,3)===Gi?(n=Gi,Yi+=3):(n=p,0===ss&&as(zi)),n===p&&(d.substr(Yi,3)===Ui?(n=Ui,Yi+=3):(n=p,0===ss&&as(Qi)),n===p&&(d.substr(Yi,2)===Zi?(n=Zi,Yi+=2):(n=p,0===ss&&as(Wi)),n===p&&(d.substr(Yi,2)===Hi?(n=Hi,Yi+=2):(n=p,0===ss&&as($i)),n===p&&(d.substr(Yi,2)===Xi?(n=Xi,Yi+=2):(n=p,0===ss&&as(Ji)))))))))))),n!==p?((i=ds())===p&&(i=C),i!==p&&(s=Io())!==p?(es=e,t=Ki(t,n,s)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f))===p&&(e=Mo()),e}function Oo(){var e,t,r,n,i,s,o,a;return e=Yi,(e=(t=Ks())!==p&&(r=ds())!==p&&(n=io())!==p?((i=ds())===p&&(i=C),i!==p?(61===d.charCodeAt(Yi)?(s=j,Yi++):(s=p,0===ss&&as(M)),s!==p?((o=ds())===p&&(o=C),o!==p&&(a=Io())!==p?t=[t,r,n,i,s,o,a]:(Yi=e,f)):(Yi=e,f)):(Yi=e,f)):(Yi=e,f))===p&&(e=Io()),e}var qo={},Do=0,Bo="vs";function Go(){return{line:os(es).line,column:os(es).column,offset:es,span:d.substring(es,Yi).length}}var zo=Qo("./ast");function Uo(e,t){return new zo(e.type,Go(),e)}if((e=n())!==p&&Yi===d.length)return e;throw e!==p&&Yi<d.length&&as({type:"end",description:"end of input"}),cs(null,is,ns)}})}),i.define("compiler/shader",function(e,t){var o={};o.Error=t("../error"),o.Object=t("../events").Object,o.ASTNode=t("./ast"),o.ASTVisitor=t("./visitor"),o.Parser=t("./parser"),o.Typechecker=t("./typecheck"),o.CodeGenerator=t("./codegen"),o.Shader=function(e,t){o.Object.call(this),this.sourceText=e;try{this.ast=o.Parser.parse(e)}catch(e){throw t===o.Shader.Type.Vertex&&(e.type=o.Error.Type.VertexShaderParsing),t===o.Shader.Type.Fragment&&(e.type=o.Error.Type.FragmentShaderParsing),e}this.type=t,this._typecheckResult=null,this._executable=null,this._shouldEmitDebuggerStatement=!1,console.assert(t===o.Shader.Type.Vertex||t===o.Shader.Type.Fragment),this._uniforms=[],this._varyings=[],this._attributes=[],this._errors=[],this._extractVariables()},o.Object.addConstructorFunctions(o.Shader),o.Shader.Event={ExecutableChanged:"shader-executable-changed"},o.Shader.Type={Vertex:"shader-type-vertex",Fragment:"shader-type-fragment"},o.Shader.prototype={constructor:o.Shader,__proto__:o.Object.prototype,get uniforms(){return this._uniforms.slice()},get attributes(){return this._attributes.slice()},get varyings(){return this._varyings.slice()},get executable(){return this._executable||(this._executable=new o.CodeGenerator(this).translateShader()),this._executable},get shouldEmitDebuggerStatement(){return this._shouldEmitDebuggerStatement},set shouldEmitDebuggerStatement(e){this._shouldEmitDebuggerStatement!==e&&(this._shouldEmitDebuggerStatement=e,this._clearExecutable())},typecheck:function(){return null!==this._typecheckResult||(this._typecheckResult=new o.Typechecker(this).typecheck()),this._typecheckResult},_extractVariables:function(){var e=new VariableExtractor;if(e.extract(this),e.errors.length){this._errors=this._errors.concat(e.errors);for(var t=0;t<this._errors.length;++t)console.error("Error extracting variables: "+JSON.stringify(this._errors[t]));throw new Error(this._errors[0].message)}this._uniforms=this._uniforms.concat(e.uniforms),this._attributes=this._attributes.concat(e.attributes),this._varyings=this._varyings.concat(e.varyings)},_clearExecutable:function(){this._executable=null,this.dispatchEventToListeners(o.Shader.Event.ExecutableChanged)}},VariableExtractor=function(){o.ASTVisitor.call(this,VariableExtractor.Functions),this.uniforms=[],this.attributes=[],this.varyings=[],this.errors=[]},VariableExtractor.prototype={__proto__:o.ASTVisitor.prototype,constructor:VariableExtractor,extract:function(e){this.shader=e,this.visitNode(e.ast),this.shader.type===o.Shader.Type.Vertex&&(this.varyings.push({name:"gl_Position",type:"vec4",qualifier:"varying",usage:"out",builtin:!0}),this.varyings.push({name:"gl_PointSize",type:"float",qualifier:"varying",usage:"out",builtin:!0})),this.shader.type===o.Shader.Type.Fragment&&(this.varyings.push({name:"gl_FragCoord",type:"vec4",qualifier:"varying",usage:"in",builtin:!0}),this.varyings.push({name:"gl_FrontFacing",type:"bool",qualifier:"varying",usage:"in",builtin:!0}),this.varyings.push({name:"gl_PointCoord",type:"vec2",qualifier:"varying",usage:"in",builtin:!0}),this.varyings.push({name:"gl_FragColor",type:"vec4",qualifier:"varying",usage:"out",builtin:!0}),this.varyings.push({name:"gl_FragData",type:"vec4[]",qualifier:"varying",usage:"out",builtin:!0})),this.shader=null},defaultVisitor:function(e){}},VariableExtractor.Functions={},VariableExtractor.Functions[o.ASTNode.Types.Program]=function(e){this.visitList(e.statements)},VariableExtractor.Functions[o.ASTNode.Types.DeclaratorItem]=function(e){return this.visitNode(e.name)},VariableExtractor.Functions[o.ASTNode.Types.Identifier]=function(e){return e.name},VariableExtractor.Functions[o.ASTNode.Types.Declarator]=function(e){var t=e.typeAttribute,r=this.visitList(e.declarators);if(this.shader.type!==o.Shader.Type.Fragment||"attribute"!==t.qualifier){var n=null;"varying"===t.qualifier&&(n=this.varyings),"uniform"===t.qualifier&&(n=this.uniforms),"attribute"===t.qualifier&&(n=this.attributes);var i=!0;this.shader.type===o.Shader.Type.Vertex&&"varying"===t.qualifier&&(i=!1),this.shader.type===o.Shader.Type.Fragment&&"gl_FragColor"==t.name&&(i=!1);for(var s=0;s<r.length;++s)n.push({type:t.name,name:r[s],qualifier:t.qualifier,usage:i?"in":"out"})}else this.errors.push({node:e,message:"'attribute' variable not allowed in fragment shader."})},e.exports=o.Shader}),i.define("compiler/program",function(e,t){var s={};s.Runtime=t("../runtime");var o={};o.Shader=t("./shader"),o.Typechecker=t("./typecheck"),o.Error=t("../error"),o.Object=t("../events").Object,o.Builtins=t("../runtime/builtins"),o.Environment=t("../runtime/environment"),o.Program=function(){o.Object.call(this),this.vertexShader=null,this.fragmentShader=null,this._linkerResult=null,this._programCode=null},o.Program.Event={ShaderChanged:"program-shader-changed",Error:"program-error"},o.Program.prototype={constructor:o.Program,__proto__:o.Object.prototype,shaderWithType:function(e){return e===o.Shader.Type.Vertex?this.vertexShader:e===o.Shader.Type.Fragment?this.fragmentShader:void console.error("Unknown shader type requested: ",e)},updateShaderWithType:function(t,e){this._linkerResult=!1,this._programCode=null;try{var r=this.shaderWithType(t),n=new o.Shader(e,t)}catch(e){var i=null;return t===o.Shader.Type.Vertex&&(i=o.Error.Type.VertexShaderParsing),t===o.Shader.Type.Fragment&&(i=o.Error.Type.FragmentShaderParsing),void this.dispatchEventToListeners(o.Program.Event.Error,{type:i,message:e.message})}t===o.Shader.Type.Fragment?this.fragmentShader=n:t===o.Shader.Type.Vertex&&(this.vertexShader=n),this.dispatchEventToListeners(o.Program.Event.ShaderChanged,{oldShader:r,newShader:n})},renderToBuffer:function(t,e){if(!this.vertexShader)throw new Error("Couldn't run shader program: no vertex shader specified.");if(!this.vertexShader.typecheck())throw new Error("Couldn't run shader program: typechecking failed for vertex shader program.");if(!this.fragmentShader)throw new Error("Couldn't run shader program: no fragment shader specified.");if(!this.fragmentShader.typecheck())throw new Error("Couldn't run shader program: typechecking failed for fragment shader program.");if(this._linkerResult||(this._linkerResult=this._linkShaders()),!this._linkerResult)throw new Error("Couldn't run shader program: linking failed.");if(!t.validateForShader(this.vertexShader))throw new Error("Couldn't run shader program: vertex shader environment validation failed.");if(!t.validateForShader(this.fragmentShader))throw new Error("Couldn't run shader program: vertex shader environment validation failed.");try{t.enterRunScope();for(var r=0;r<e.height;++r){t.get("gl_FragCoord").set("y",r);for(var n=0;n<e.width;++n){t.get("gl_FragCoord").set("x",n),this.fragmentShader.executable.code.call(null,s,t);var i=t.get("gl_FragColor");i=o.Builtins.clamp(i,0,1),e.data[4*(e.width*r+n)+0]=255*i.d[0],e.data[4*(e.width*r+n)+1]=255*i.d[1],e.data[4*(e.width*r+n)+2]=255*i.d[2],e.data[4*(e.width*r+n)+3]=255*i.d[3]}}t.exitRunScope()}catch(e){t.exitRunScope()}},runShaderWithType:function(e,t){var r=this.shaderWithType(e);r&&this._runSingleShader(r,t)},runShaders:function(e){(this.vertexShader||this.fragmentShader)&&(this.fragmentShader&&this._runSingleShader(this.fragmentShader,e),this.vertexShader&&this._runSingleShader(this.vertexShader,e))},_runSingleShader:function(t,r){if(console.assert(t instanceof o.Shader,t),console.assert(r instanceof o.Environment,r),!t)throw new Error("Couldn't run single shader: the shader was empty.");if(!t.typecheck())throw new Error("Couldn't run single shader: typechecking failed.");if(!r.validateForShader(t))throw new Error("Couldn't run single shader: environment validation failed.");if(t.executable.error){var e={type:n=t.type===o.Shader.Type.Vertex?o.Error.Type.VertexShaderTranslation:o.Error.Type.FragmentShaderTranslation,message:t.executable.error};this.dispatchEventToListeners(o.Program.Event.Error,e)}else{r.enterRunScope();try{t.executable.code.call(null,s,r)}catch(e){var n=t.type===o.Shader.Type.Vertex?o.Error.Type.VertexShaderExecution:o.Error.Type.FragmentShaderExecution;return r.exitRunScope(),void this.dispatchEventToListeners(o.Program.Event.Error,{type:n,message:e.message})}r.exitRunScope()}},_linkShaders:function(){return!0}},e.exports=o.Program}),i.define("glsl",function(e,t){var r={VERSION:"0.1.0",Parser:t("./compiler/parser"),PrettyPrinter:t("./compiler/pretty"),Shader:t("./compiler/shader"),Program:t("./compiler/program"),Runtime:t("./runtime"),Environment:t("./runtime/environment"),Object:t("./events").Object,Event:t("./events").Event,Error:t("./error")};e.exports=r}),i.glsl}();